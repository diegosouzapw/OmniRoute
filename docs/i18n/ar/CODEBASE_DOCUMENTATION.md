# Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - ÙˆØ«Ø§Ø¦Ù‚ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©

ğŸŒ **Languages:** ğŸ‡ºğŸ‡¸ [English](../../CODEBASE_DOCUMENTATION.md) | ğŸ‡§ğŸ‡· [PortuguÃªs (Brasil)](../pt-BR/CODEBASE_DOCUMENTATION.md) | ğŸ‡ªğŸ‡¸ [EspaÃ±ol](../es/CODEBASE_DOCUMENTATION.md) | ğŸ‡«ğŸ‡· [FranÃ§ais](../fr/CODEBASE_DOCUMENTATION.md) | ğŸ‡®ğŸ‡¹ [Italiano](../it/CODEBASE_DOCUMENTATION.md) | ğŸ‡·ğŸ‡º [Ğ ÑƒÑÑĞºĞ¸Ğ¹](../ru/CODEBASE_DOCUMENTATION.md) | ğŸ‡¨ğŸ‡³ [ä¸­æ–‡ (ç®€ä½“)](../zh-CN/CODEBASE_DOCUMENTATION.md) | ğŸ‡©ğŸ‡ª [Deutsch](../de/CODEBASE_DOCUMENTATION.md) | ğŸ‡®ğŸ‡³ [à¤¹à¤¿à¤¨à¥à¤¦à¥€](../in/CODEBASE_DOCUMENTATION.md) | ğŸ‡¹ğŸ‡­ [à¹„à¸—à¸¢](../th/CODEBASE_DOCUMENTATION.md) | ğŸ‡ºğŸ‡¦ [Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°](../uk-UA/CODEBASE_DOCUMENTATION.md) | ğŸ‡¸ğŸ‡¦ [Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©](../ar/CODEBASE_DOCUMENTATION.md) | ğŸ‡¯ğŸ‡µ [æ—¥æœ¬èª](../ja/CODEBASE_DOCUMENTATION.md) | ğŸ‡»ğŸ‡³ [Tiáº¿ng Viá»‡t](../vi/CODEBASE_DOCUMENTATION.md) | ğŸ‡§ğŸ‡¬ [Ğ‘ÑŠĞ»Ğ³Ğ°Ñ€ÑĞºĞ¸](../bg/CODEBASE_DOCUMENTATION.md) | ğŸ‡©ğŸ‡° [Dansk](../da/CODEBASE_DOCUMENTATION.md) | ğŸ‡«ğŸ‡® [Suomi](../fi/CODEBASE_DOCUMENTATION.md) | ğŸ‡®ğŸ‡± [×¢×‘×¨×™×ª](../he/CODEBASE_DOCUMENTATION.md) | ğŸ‡­ğŸ‡º [Magyar](../hu/CODEBASE_DOCUMENTATION.md) | ğŸ‡®ğŸ‡© [Bahasa Indonesia](../id/CODEBASE_DOCUMENTATION.md) | ğŸ‡°ğŸ‡· [í•œêµ­ì–´](../ko/CODEBASE_DOCUMENTATION.md) | ğŸ‡²ğŸ‡¾ [Bahasa Melayu](../ms/CODEBASE_DOCUMENTATION.md) | ğŸ‡³ğŸ‡± [Nederlands](../nl/CODEBASE_DOCUMENTATION.md) | ğŸ‡³ğŸ‡´ [Norsk](../no/CODEBASE_DOCUMENTATION.md) | ğŸ‡µğŸ‡¹ [PortuguÃªs (Portugal)](../pt/CODEBASE_DOCUMENTATION.md) | ğŸ‡·ğŸ‡´ [RomÃ¢nÄƒ](../ro/CODEBASE_DOCUMENTATION.md) | ğŸ‡µğŸ‡± [Polski](../pl/CODEBASE_DOCUMENTATION.md) | ğŸ‡¸ğŸ‡° [SlovenÄina](../sk/CODEBASE_DOCUMENTATION.md) | ğŸ‡¸ğŸ‡ª [Svenska](../sv/CODEBASE_DOCUMENTATION.md) | ğŸ‡µğŸ‡­ [Filipino](../phi/CODEBASE_DOCUMENTATION.md)

> Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ ÙˆÙ…Ù†Ø§Ø³Ø¨ Ù„Ù„Ù…Ø¨ØªØ¯Ø¦ÙŠÙ† Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Ø² Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ÙˆÙƒÙŠÙ„ AI **omniroute** Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆÙØ±ÙŠÙ†.

---

## 1. Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ØŸ

omniroute Ù‡Ùˆ **Ø¬Ù‡Ø§Ø² ØªÙˆØ¬ÙŠÙ‡ ÙˆÙƒÙŠÙ„** ÙŠÙ‚Ø¹ Ø¨ÙŠÙ† Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (Claude CLIØŒ ÙˆCodexØŒ ÙˆCursor IDEØŒ ÙˆÙ…Ø§ Ø¥Ù„Ù‰ Ø°Ù„Ùƒ) ÙˆÙ…ÙˆÙØ±ÙŠ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (AnthropicØŒ ÙˆGoogleØŒ ÙˆOpenAIØŒ ÙˆAWSØŒ ÙˆGitHubØŒ ÙˆÙ…Ø§ Ø¥Ù„Ù‰ Ø°Ù„Ùƒ). Ø¥Ù†Ù‡ ÙŠØ­Ù„ Ù…Ø´ÙƒÙ„Ø© ÙˆØ§Ø­Ø¯Ø© ÙƒØ¨ÙŠØ±Ø©:

> **ÙŠØªØ­Ø¯Ø« Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…Ø®ØªÙ„ÙÙˆÙ† "Ù„ØºØ§Øª" Ù…Ø®ØªÙ„ÙØ© (ØªÙ†Ø³ÙŠÙ‚Ø§Øª ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª)ØŒ ÙˆÙŠØªÙˆÙ‚Ø¹ Ù…Ù‚Ø¯Ù…Ùˆ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…Ø®ØªÙ„ÙÙˆÙ† "Ù„ØºØ§Øª" Ù…Ø®ØªÙ„ÙØ© Ø£ÙŠØ¶Ù‹Ø§. ** ÙŠØªØ±Ø¬Ù… Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø´Ø§Ù…Ù„ Ø¨ÙŠÙ†Ù‡Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.

ÙÙƒØ± ÙÙŠ Ø§Ù„Ø£Ù…Ø± ÙˆÙƒØ£Ù†Ù‡ Ù…ØªØ±Ø¬Ù… Ø¹Ø§Ù„Ù…ÙŠ ÙÙŠ Ø§Ù„Ø£Ù…Ù… Ø§Ù„Ù…ØªØ­Ø¯Ø© - ÙŠÙ…ÙƒÙ† Ù„Ø£ÙŠ Ù…Ù†Ø¯ÙˆØ¨ Ø§Ù„ØªØ­Ø¯Ø« Ø¨Ø£ÙŠ Ù„ØºØ©ØŒ ÙˆÙŠÙ‚ÙˆÙ… Ø§Ù„Ù…ØªØ±Ø¬Ù… Ø¨ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ù„Ø£ÙŠ Ù…Ù†Ø¯ÙˆØ¨ Ø¢Ø®Ø±.

---

## 2. Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©

```mermaid
graph LR
    subgraph Clients
        A[Claude CLI]
        B[Codex]
        C[Cursor IDE]
        D[OpenAI-compatible]
    end

    subgraph omniroute
        E[Handler Layer]
        F[Translator Layer]
        G[Executor Layer]
        H[Services Layer]
    end

    subgraph Providers
        I[Anthropic Claude]
        J[Google Gemini]
        K[OpenAI / Codex]
        L[GitHub Copilot]
        M[AWS Kiro]
        N[Antigravity]
        O[Cursor API]
    end

    A --> E
    B --> E
    C --> E
    D --> E
    E --> F
    F --> G
    G --> I
    G --> J
    G --> K
    G --> L
    G --> M
    G --> N
    G --> O
    H -.-> E
    H -.-> G
```

### Ø§Ù„Ù…Ø¨Ø¯Ø£ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ: Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø­ÙˆØ±ÙŠØ©

ØªÙ…Ø± Ø¬Ù…ÙŠØ¹ ØªØ±Ø¬Ù…Ø© Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¹Ø¨Ø± **ØªÙ†Ø³ÙŠÙ‚ OpenAI ÙƒÙ…Ø±ÙƒØ²**:

```
Client Format â†’ [OpenAI Hub] â†’ Provider Format    (request)
Provider Format â†’ [OpenAI Hub] â†’ Client Format    (response)
```

Ù‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù†Ùƒ ØªØ­ØªØ§Ø¬ ÙÙ‚Ø· Ø¥Ù„Ù‰ Ù…ØªØ±Ø¬Ù…ÙŠÙ† **N** (ÙˆØ§Ø­Ø¯ Ù„ÙƒÙ„ ØªÙ†Ø³ÙŠÙ‚) Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† **NÂ²** (ÙƒÙ„ Ø²ÙˆØ¬).

---

## 3. Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹

```
omniroute/
â”œâ”€â”€ open-sse/                  â† Core proxy library (portable, framework-agnostic)
â”‚   â”œâ”€â”€ index.js               â† Main entry point, exports everything
â”‚   â”œâ”€â”€ config/                â† Configuration & constants
â”‚   â”œâ”€â”€ executors/             â† Provider-specific request execution
â”‚   â”œâ”€â”€ handlers/              â† Request handling orchestration
â”‚   â”œâ”€â”€ services/              â† Business logic (auth, models, fallback, usage)
â”‚   â”œâ”€â”€ translator/            â† Format translation engine
â”‚   â”‚   â”œâ”€â”€ request/           â† Request translators (8 files)
â”‚   â”‚   â”œâ”€â”€ response/          â† Response translators (7 files)
â”‚   â”‚   â””â”€â”€ helpers/           â† Shared translation utilities (6 files)
â”‚   â””â”€â”€ utils/                 â† Utility functions
â”œâ”€â”€ src/                       â† Application layer (Express/Worker runtime)
â”‚   â”œâ”€â”€ app/                   â† Web UI, API routes, middleware
â”‚   â”œâ”€â”€ lib/                   â† Database, auth, and shared library code
â”‚   â”œâ”€â”€ mitm/                  â† Man-in-the-middle proxy utilities
â”‚   â”œâ”€â”€ models/                â† Database models
â”‚   â”œâ”€â”€ shared/                â† Shared utilities (wrappers around open-sse)
â”‚   â”œâ”€â”€ sse/                   â† SSE endpoint handlers
â”‚   â””â”€â”€ store/                 â† State management
â”œâ”€â”€ data/                      â† Runtime data (credentials, logs)
â”‚   â””â”€â”€ provider-credentials.json   (external credentials override, gitignored)
â””â”€â”€ tester/                    â† Test utilities
```

---

## 4. ØªÙØµÙŠÙ„ Ø§Ù„ÙˆØ­Ø¯Ø© ØªÙ„Ùˆ Ø§Ù„Ø£Ø®Ø±Ù‰

### 4.1 Ø§Ù„ØªÙƒÙˆÙŠÙ† (`open-sse/config/`)

**Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„ÙˆØ­ÙŠØ¯ Ù„Ù„Ø­Ù‚ÙŠÙ‚Ø©** Ù„Ø¬Ù…ÙŠØ¹ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙØ±.

| Ù…Ù„Ù                           | Ø§Ù„ØºØ±Ø¶                                                                                                                                                                                                                        |
| ----------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `constants.ts`                | ÙƒØ§Ø¦Ù† `PROVIDERS` ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¹Ù†Ø§ÙˆÙŠÙ† URL Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙˆØ¨ÙŠØ§Ù†Ø§Øª Ø§Ø¹ØªÙ…Ø§Ø¯ OAuth (Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©) ÙˆØ§Ù„Ø±Ø¤ÙˆØ³ ÙˆÙ…Ø·Ø§Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„ÙƒÙ„ Ù…ÙˆÙØ±. ÙŠØ­Ø¯Ø¯ Ø£ÙŠØ¶Ù‹Ø§ `HTTP_STATUS`ØŒ Ùˆ`ERROR_TYPES`ØŒ Ùˆ`COOLDOWN_MS`ØŒ Ùˆ`BACKOFF_CONFIG`ØŒ Ùˆ`SKIP_PATTERNS`. |
| `credentialLoader.ts`         | ÙŠÙ‚ÙˆÙ… Ø¨ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© Ù…Ù† `data/provider-credentials.json` ÙˆÙŠØ¯Ù…Ø¬Ù‡Ø§ ÙÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø§Ù„Ù…Ø´ÙØ±Ø© ÙÙŠ `PROVIDERS`. ÙŠØ­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø±Ø§Ø± Ø®Ø§Ø±Ø¬ Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù…ØµØ¯Ø± Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©.      |
| `providerModels.ts`           | Ø³Ø¬Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ: Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±Ø© Ù„Ù…ÙˆÙØ± Ø§Ù„Ø®Ø±Ø§Ø¦Ø· â†’ Ù…Ø¹Ø±ÙØ§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬. ÙˆØ¸Ø§Ø¦Ù Ù…Ø«Ù„ `getModels()`ØŒ `getProviderByAlias()`.                                                                                                      |
| `codexInstructions.ts`        | ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙŠ ØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡Ø§ ÙÙŠ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯Ø³ØªÙˆØ± Ø§Ù„ØºØ°Ø§Ø¦ÙŠ (Ù‚ÙŠÙˆØ¯ Ø§Ù„ØªØ­Ø±ÙŠØ±ØŒ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ØŒ Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©).                                                                                                                     |
| `defaultThinkingSignature.ts` | ØªÙˆÙ‚ÙŠØ¹Ø§Øª "Ø§Ù„ØªÙÙƒÙŠØ±" Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù†Ù…Ø§Ø°Ø¬ ÙƒÙ„ÙˆØ¯ ÙˆØ¬ÙŠÙ…ÙŠÙ†ÙŠ.                                                                                                                                                                            |
| `ollamaModels.ts`             | ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…Ø®Ø·Ø· Ù„Ù†Ù…Ø§Ø°Ø¬ Ø£ÙˆÙ„Ø§Ù…Ø§ Ø§Ù„Ù…Ø­Ù„ÙŠØ© (Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ø­Ø¬Ù…ØŒ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©ØŒ Ø§Ù„ØªÙƒÙ…ÙŠÙ…).                                                                                                                                                         |

#### ØªØ¯ÙÙ‚ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯

```mermaid
flowchart TD
    A["App starts"] --> B["constants.ts defines PROVIDERS\nwith hardcoded defaults"]
    B --> C{"data/provider-credentials.json\nexists?"}
    C -->|Yes| D["credentialLoader reads JSON"]
    C -->|No| E["Use hardcoded defaults"]
    D --> F{"For each provider in JSON"}
    F --> G{"Provider exists\nin PROVIDERS?"}
    G -->|No| H["Log warning, skip"]
    G -->|Yes| I{"Value is object?"}
    I -->|No| J["Log warning, skip"]
    I -->|Yes| K["Merge clientId, clientSecret,\ntokenUrl, authUrl, refreshUrl"]
    K --> F
    H --> F
    J --> F
    F -->|Done| L["PROVIDERS ready with\nmerged credentials"]
    E --> L
```

---

### 4.2 Ø§Ù„Ù…Ù†ÙØ°ÙˆÙ† (`open-sse/executors/`)

ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù…Ù†ÙØ°ÙˆÙ† Ø¨ØªØºÙ„ÙŠÙ **Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø²ÙˆØ¯** Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… **Ù†Ù…Ø· Ø§Ù„Ø¥Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©**. ÙŠØªØ¬Ø§ÙˆØ² ÙƒÙ„ Ù…Ù†ÙØ° Ø§Ù„Ø£Ø³Ø§Ù„ÙŠØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©.

```mermaid
classDiagram
    class BaseExecutor {
        +buildUrl(model, stream, options)
        +buildHeaders(credentials, stream, body)
        +transformRequest(body, model, stream, credentials)
        +execute(url, options)
        +shouldRetry(status, error)
        +refreshCredentials(credentials, log)
    }

    class DefaultExecutor {
        +refreshCredentials()
    }

    class AntigravityExecutor {
        +buildUrl()
        +buildHeaders()
        +transformRequest()
        +shouldRetry()
        +refreshCredentials()
    }

    class CursorExecutor {
        +buildUrl()
        +buildHeaders()
        +transformRequest()
        +parseResponse()
        +generateChecksum()
    }

    class KiroExecutor {
        +buildUrl()
        +buildHeaders()
        +transformRequest()
        +parseEventStream()
        +refreshCredentials()
    }

    BaseExecutor <|-- DefaultExecutor
    BaseExecutor <|-- AntigravityExecutor
    BaseExecutor <|-- CursorExecutor
    BaseExecutor <|-- KiroExecutor
    BaseExecutor <|-- CodexExecutor
    BaseExecutor <|-- GeminiCLIExecutor
    BaseExecutor <|-- GithubExecutor
```

| Ø§Ù„Ù…Ù†ÙØ°           | Ù…Ù‚Ø¯Ù…                                                | Ø§Ù„ØªØ®ØµØµØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©                                                                                                                                   |
| ---------------- | --------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------- |
| `base.ts`        | â€”                                                   | Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ù„Ø®ØµØ§Øª: Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ÙˆØ§Ù† URLØŒ ÙˆØ§Ù„Ø±Ø¤ÙˆØ³ØŒ ÙˆÙ…Ù†Ø·Ù‚ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©ØŒ ÙˆØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯                                                              |
| `default.ts`     | ÙƒÙ„ÙˆØ¯ØŒ Ø¬ÙŠÙ…ÙŠÙ†ÙŠØŒ Ø£ÙˆØ¨Ù† Ø¢ÙŠ Ø¢ÙŠØŒ Ø¬ÙŠ Ø¥Ù„ Ø¥Ù…ØŒ ÙƒÙŠÙ…ÙŠØŒ Ù…ÙŠÙ†ÙŠ Ù…Ø§ÙƒØ³ | ØªØ­Ø¯ÙŠØ« Ø±Ù…Ø² OAuth Ø§Ù„Ø¹Ø§Ù… Ù„Ù„Ù…ÙˆÙØ±ÙŠÙ† Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠÙŠÙ†                                                                                                            |
| `antigravity.ts` | Ø¬ÙˆØ¬Ù„ ÙƒÙ„Ø§ÙˆØ¯ ÙƒÙˆØ¯                                      | Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹/Ø§Ù„Ø¬Ù„Ø³Ø©ØŒ ÙˆØ¥Ø±Ø¬Ø§Ø¹ Ø¹Ù†Ø§ÙˆÙŠÙ† URL Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©ØŒ ÙˆØ¥Ø¹Ø§Ø¯Ø© Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®ØµØµØ© Ù…Ù† Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ ("Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø¨Ø¹Ø¯ 2 Ø³Ø§Ø¹Ø© Ùˆ7 Ø¯Ù‚Ø§Ø¦Ù‚ Ùˆ23 Ø«Ø§Ù†ÙŠØ©") |
| `cursor.ts`      | Ø¨ÙŠØ¦Ø© ØªØ·ÙˆÙŠØ± Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù…Ø¤Ø´Ø±                           | **Ø§Ù„Ø£ÙƒØ«Ø± ØªØ¹Ù‚ÙŠØ¯Ù‹Ø§**: Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ÙŠ SHA-256ØŒ ÙˆØªØ±Ù…ÙŠØ² Ø·Ù„Ø¨ ProtobufØŒ ÙˆEventStream Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠ â†’ ØªØ­Ù„ÙŠÙ„ Ø§Ø³ØªØ¬Ø§Ø¨Ø© SSE                                 |
| `codex.ts`       | OpenAI Codex                                        | Ø¥Ø¯Ø®Ø§Ù„ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…ØŒ ÙˆØ¥Ø¯Ø§Ø±Ø© Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ØªÙÙƒÙŠØ±ØŒ ÙˆØ¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©                                                                          |
| `gemini-cli.ts`  | Ø¬ÙˆØ¬Ù„ Ø§Ù„Ø¬ÙˆØ²Ø§Ø¡ CLI                                    | Ø¨Ù†Ø§Ø¡ Ø¹Ù†ÙˆØ§Ù† URL Ø§Ù„Ù…Ø®ØµØµ (`streamGenerateContent`)ØŒ ØªØ­Ø¯ÙŠØ« Ø±Ù…Ø² OAuth Ø§Ù„Ù…Ù…ÙŠØ² Ù„Ù€ Google                                                                   |
| `github.ts`      | Ø¬ÙŠØ«Ø¨ Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø·ÙŠØ§Ø±                                   | Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ (GitHub OAuth + Copilot token)ØŒ Ù…Ø­Ø§ÙƒØ§Ø© Ø±Ø£Ø³ VSCode                                                                                |
| `kiro.ts`        | AWS CodeWhisperer                                   | Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠ Ù„Ù€ AWS EventStreamØŒ ÙˆØ¥Ø·Ø§Ø±Ø§Øª Ø£Ø­Ø¯Ø§Ø« AMZNØŒ ÙˆØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…Ù…ÙŠØ²                                                                         |
| `index.ts`       | â€”                                                   | Ø§Ù„Ù…ØµÙ†Ø¹: Ø§Ø³Ù… Ù…ÙˆÙØ± Ø§Ù„Ø®Ø±Ø§Ø¦Ø· â† ÙØ¦Ø© Ø§Ù„Ù…Ù†ÙØ°ØŒ Ù…Ø¹ Ø®ÙŠØ§Ø± Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠ                                                                                      |

---

### 4.3 Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø§Øª (`open-sse/handlers/`)

**Ø·Ø¨Ù‚Ø© Ø§Ù„ØªÙ†Ø³ÙŠÙ‚** â€” ØªØªÙˆÙ„Ù‰ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ±Ø¬Ù…Ø© ÙˆØ§Ù„ØªÙ†ÙÙŠØ° ÙˆØ§Ù„ØªØ¯ÙÙ‚ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡.

| Ù…Ù„Ù                   | Ø§Ù„ØºØ±Ø¶                                                                                                                                                                                              |
| --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chatCore.ts`         | ** Ø§Ù„Ù…Ù†Ø³Ù‚ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ ** (~ 600 Ø³Ø·Ø±). ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø¯ÙˆØ±Ø© Ø­ÙŠØ§Ø© Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„ÙƒØ§Ù…Ù„Ø©: Ø§ÙƒØªØ´Ø§Ù Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ â† Ø§Ù„ØªØ±Ø¬Ù…Ø© â† Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù†ÙØ° â† Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„ØªØ¯ÙÙ‚/ØºÙŠØ± Ø§Ù„Ù…ØªØ¯ÙÙ‚ â† ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…Ù…ÙŠØ² â† Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ â† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…. |
| `responsesHandler.ts` | Ù…Ø­ÙˆÙ„ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª OpenAI: ÙŠØ­ÙˆÙ„ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø±Ø¯ÙˆØ¯ â† Ø¥ÙƒÙ…Ø§Ù„Ø§Øª Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© â† ÙŠØ±Ø³Ù„ Ø¥Ù„Ù‰ `chatCore` â† ÙŠØ­ÙˆÙ„ SSE Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¥Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø±Ø¯ÙˆØ¯.                                                          |
| `embeddings.ts`       | Ù…Ø¹Ø§Ù„Ø¬ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØ¶Ù…ÙŠÙ†: ÙŠØ­Ù„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ¶Ù…ÙŠÙ† â†’ Ø§Ù„Ù…ÙˆÙØ±ØŒ ÙˆÙŠØ±Ø³Ù„ Ø¥Ù„Ù‰ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…ÙˆÙØ±ØŒ ÙˆÙŠØ¹ÙŠØ¯ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ OpenAI. ÙŠØ¯Ø¹Ù… 6+ Ù…Ù‚Ø¯Ù…ÙŠ Ø§Ù„Ø®Ø¯Ù…Ø§Øª.                                           |
| `imageGeneration.ts`  | Ù…Ø¹Ø§Ù„Ø¬ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ±: ÙŠØ­Ù„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØµÙˆØ±Ø© â†’ Ø§Ù„Ù…ÙˆÙØ±ØŒ ÙˆÙŠØ¯Ø¹Ù… Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹ Ø§Ù„Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ OpenAIØŒ ÙˆGemini-image (Antigravity)ØŒ ÙˆØ§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ (Nebius). Ø¥Ø±Ø¬Ø§Ø¹ ØµÙˆØ± base64 Ø£Ùˆ URL.                                  |

#### Ø¯ÙˆØ±Ø© Ø­ÙŠØ§Ø© Ø§Ù„Ø·Ù„Ø¨ (chatCore.ts)

```mermaid
sequenceDiagram
    participant Client
    participant chatCore
    participant Translator
    participant Executor
    participant Provider

    Client->>chatCore: Request (any format)
    chatCore->>chatCore: Detect source format
    chatCore->>chatCore: Check bypass patterns
    chatCore->>chatCore: Resolve model & provider
    chatCore->>Translator: Translate request (source â†’ OpenAI â†’ target)
    chatCore->>Executor: Get executor for provider
    Executor->>Executor: Build URL, headers, transform request
    Executor->>Executor: Refresh credentials if needed
    Executor->>Provider: HTTP fetch (streaming or non-streaming)

    alt Streaming
        Provider-->>chatCore: SSE stream
        chatCore->>chatCore: Pipe through SSE transform stream
        Note over chatCore: Transform stream translates<br/>each chunk: target â†’ OpenAI â†’ source
        chatCore-->>Client: Translated SSE stream
    else Non-streaming
        Provider-->>chatCore: JSON response
        chatCore->>Translator: Translate response
        chatCore-->>Client: Translated JSON
    end

    alt Error (401, 429, 500...)
        chatCore->>Executor: Retry with credential refresh
        chatCore->>chatCore: Account fallback logic
    end
```

---

### 4.4 Ø§Ù„Ø®Ø¯Ù…Ø§Øª (`open-sse/services/`)

Ù…Ù†Ø·Ù‚ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø°ÙŠ ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø§Øª ÙˆØ§Ù„Ù…Ù†ÙØ°ÙŠÙ†.

| Ù…Ù„Ù                  | Ø§Ù„ØºØ±Ø¶                                                                                                                                                                                                                                                                                           |
| -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `provider.ts`        | **ÙƒØ´Ù Ø§Ù„ØªÙ†Ø³ÙŠÙ‚** (`detectFormat`): ØªØ­Ù„ÙŠÙ„Ø§Øª Ø¨Ù†ÙŠØ© Ø§Ù„Ø¬Ø³Ù… Ù„ØªØ­Ø¯ÙŠØ¯ ØªÙ†Ø³ÙŠÙ‚Ø§Øª Claude/OpenAI/Gemini/Antigravity/Responses (ØªØªØ¶Ù…Ù† `max_tokens` Ø§Ù„Ø§Ø³ØªØ¯Ù„Ø§Ù„ Ù„ÙƒÙ„ÙˆØ¯). Ø£ÙŠØ¶Ù‹Ø§: Ø¨Ù†Ø§Ø¡ Ø¹Ù†ÙˆØ§Ù† URLØŒ ÙˆØ¨Ù†Ø§Ø¡ Ø§Ù„Ø±Ø£Ø³ØŒ ÙˆØªØ·Ø¨ÙŠØ¹ ØªÙƒÙˆÙŠÙ† Ø§Ù„ØªÙÙƒÙŠØ±. ÙŠØ¯Ø¹Ù… Ù…ÙˆÙØ±ÙŠ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙŠÙ† `openai-compatible-*` Ùˆ`anthropic-compatible-*`. |
| `model.ts`           | ØªØ­Ù„ÙŠÙ„ Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ (`claude/model-name` â†’ `{provider: "claude", model: "model-name"}`)ØŒ ÙˆØ¯Ù‚Ø© Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø± Ù…Ø¹ Ø§ÙƒØªØ´Ø§Ù Ø§Ù„ØªØµØ§Ø¯Ù…ØŒ ÙˆØªØ¹Ù‚ÙŠÙ… Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (ÙŠØ±ÙØ¶ Ø£Ø­Ø±Ù Ø§Ø¬ØªÙŠØ§Ø² Ø§Ù„Ù…Ø³Ø§Ø±/Ø§Ù„ØªØ­ÙƒÙ…)ØŒ ÙˆØ¯Ù‚Ø© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù…Ø¹ Ø¯Ø¹Ù… getter Ù„Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø± ØºÙŠØ± Ø§Ù„Ù…ØªØ²Ø§Ù…Ù†.                                                |
| `accountFallback.ts` | Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ù…Ø¹Ø¯Ù„: Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø§Ù„Ø£Ø³ÙŠ (1s â†’ 2s â†’ 4s â†’ 2min ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰)ØŒ ÙˆØ¥Ø¯Ø§Ø±Ø© ÙØªØ±Ø© ØªÙ‡Ø¯Ø¦Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ ÙˆØªØµÙ†ÙŠÙ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ (Ø£ÙŠ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ØªØ¤Ø¯ÙŠ Ø¥Ù„Ù‰ Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ù…Ù‚Ø§Ø¨Ù„ Ø¹Ø¯Ù… Ø­Ø¯ÙˆØ«Ù‡).                                                                                                                            |
| `tokenRefresh.ts`    | ØªØ­Ø¯ÙŠØ« Ø±Ù…Ø² OAuth Ø§Ù„Ù…Ù…ÙŠØ² **Ù„ÙƒÙ„ Ù…Ø²ÙˆØ¯**: Google (GeminiØŒ Antigravity)ØŒ ClaudeØŒ CodexØŒ QwenØŒ iFlowØŒ GitHub (OAuth + Copilot Dual-Token)ØŒ Kiro (AWS SSO OIDC + Social Auth). ÙŠØªØ¶Ù…Ù† Ø°Ø§ÙƒØ±Ø© ØªØ®Ø²ÙŠÙ† Ù…Ø¤Ù‚Øª Ù„Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø±Ø­Ù„Ø© ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø¹ Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø§Ù„Ù…ØªØ³Ø§Ø±Ø¹.                         |
| `combo.ts`           | **Ù†Ù…Ø§Ø°Ø¬ Ù…Ø¬Ù…Ø¹Ø©**: Ø³Ù„Ø§Ø³Ù„ Ù…Ù† Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©. Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ A Ù…Ø¹ ÙˆØ¬ÙˆØ¯ Ø®Ø·Ø£ Ù…Ø¤Ù‡Ù„ Ù„Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„ÙŠÙ‡ØŒ ÙØ¬Ø±Ù‘Ø¨ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ BØŒ Ø«Ù… CØŒ ÙˆÙ…Ø§ Ø¥Ù„Ù‰ Ø°Ù„Ùƒ. ÙŠÙ‚ÙˆÙ… Ø¨Ø¥Ø±Ø¬Ø§Ø¹ Ø±Ù…ÙˆØ² Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ© Ø§Ù„ÙØ¹Ù„ÙŠØ©.                                                                                                                      |
| `usage.ts`           | Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ØµØµ/Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† ÙˆØ§Ø¬Ù‡Ø§Øª Ø¨Ø±Ù…Ø¬Ø© ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…ÙˆÙØ± (Ø­ØµØµ GitHub CopilotØŒ ÙˆØ­ØµØµ Ù†Ù…Ø§Ø°Ø¬ AntigravityØŒ ÙˆØ­Ø¯ÙˆØ¯ Ù…Ø¹Ø¯Ù„ CodexØŒ ÙˆØ£Ø¹Ø·Ø§Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù… KiroØŒ ÙˆØ¥Ø¹Ø¯Ø§Ø¯Ø§Øª Claude).                                                                                                                                 |
| `accountSelector.ts` | Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø°ÙƒÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ÙŠØ£Ø®Ø° ÙÙŠ Ø§Ù„Ø§Ø¹ØªØ¨Ø§Ø± Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© ÙˆØ§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ© ÙˆØ§Ù„Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠ ÙˆØ­Ø§Ù„Ø© Ø§Ù„ØªÙ‡Ø¯Ø¦Ø© Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ù…Ø«Ù„ Ù„ÙƒÙ„ Ø·Ù„Ø¨.                                                                                                                                            |
| `contextManager.ts`  | Ø¥Ø¯Ø§Ø±Ø© Ø¯ÙˆØ±Ø© Ø­ÙŠØ§Ø© Ø³ÙŠØ§Ù‚ Ø§Ù„Ø·Ù„Ø¨: Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØªØ¨Ø¹ ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ø³ÙŠØ§Ù‚ Ù„ÙƒÙ„ Ø·Ù„Ø¨ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¹Ø±ÙŠÙ (Ù…Ø¹Ø±Ù Ø§Ù„Ø·Ù„Ø¨ØŒ ÙˆØ§Ù„Ø·ÙˆØ§Ø¨Ø¹ Ø§Ù„Ø²Ù…Ù†ÙŠØ©ØŒ ÙˆÙ…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙØ±) Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„.                                                                                                                                  |
| `ipFilter.ts`        | Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø¥Ù„Ù‰ IP: ÙŠØ¯Ø¹Ù… ÙˆØ¶Ø¹ÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§ ÙˆØ§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø¸ÙˆØ±Ø©. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø¹Ù†ÙˆØ§Ù† IP Ù„Ù„Ø¹Ù…ÙŠÙ„ Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªÙŠ ØªÙ… ØªÙƒÙˆÙŠÙ†Ù‡Ø§ Ù‚Ø¨Ù„ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ø§Øª ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª.                                                                                                           |
| `sessionManager.ts`  | ØªØªØ¨Ø¹ Ø§Ù„Ø¬Ù„Ø³Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ØµÙ…Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„: ÙŠØªØªØ¨Ø¹ Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹Ø±ÙØ§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¬Ø²Ø£Ø©ØŒ ÙˆÙŠØ±Ø§Ù‚Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§ØªØŒ ÙˆÙŠÙˆÙØ± Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„Ø¬Ù„Ø³Ø©.                                                                                                                                                                 |
| `signatureCache.ts`  | Ø·Ù„Ø¨ Ø°Ø§ÙƒØ±Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª Ù„Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø© Ø¥Ù„Ù‰ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹: ÙŠÙ…Ù†Ø¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© Ø¹Ù† Ø·Ø±ÙŠÙ‚ ØªØ®Ø²ÙŠÙ† ØªÙˆÙ‚ÙŠØ¹Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø£Ø®ÙŠØ±Ø© Ù…Ø¤Ù‚ØªÙ‹Ø§ ÙˆØ¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø© Ù…Ø¤Ù‚ØªÙ‹Ø§ Ù„Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªØ·Ø§Ø¨Ù‚Ø© Ø®Ù„Ø§Ù„ Ù†Ø§ÙØ°Ø© Ø²Ù…Ù†ÙŠØ©.                                                                                     |
| `systemPrompt.ts`    | Ø§Ù„Ø­Ù‚Ù† Ø§Ù„ÙÙˆØ±ÙŠ Ù„Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ: ÙŠÙÙ„Ø­Ù‚ Ø£Ùˆ ÙŠÙÙ„Ø­Ù‚ Ù…ÙˆØ¬Ù‡ Ù†Ø¸Ø§Ù… Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙƒÙˆÙŠÙ† Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§ØªØŒ Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØªÙˆØ§ÙÙ‚ Ù„ÙƒÙ„ Ù…Ø²ÙˆØ¯.                                                                                                                                                                                   |
| `thinkingBudget.ts`  | Ø¥Ø¯Ø§Ø±Ø© Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ù…Ù…ÙŠØ²Ø©: ØªØ¯Ø¹Ù… Ø£ÙˆØ¶Ø§Ø¹ Ø§Ù„Ù…Ø±ÙˆØ±ØŒ ÙˆØ§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (ØªÙƒÙˆÙŠÙ† Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ø´Ø±ÙŠØ·ÙŠ)ØŒ ÙˆØ§Ù„Ù…Ø®ØµØµ (Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø«Ø§Ø¨ØªØ©)ØŒ ÙˆØ§Ù„ØªÙƒÙŠÙÙŠØ© (Ù…Ø¯Ø±Ø¬Ø© Ø§Ù„ØªØ¹Ù‚ÙŠØ¯) Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø±Ù…ÙˆØ² Ø§Ù„ØªÙÙƒÙŠØ±/Ø§Ù„Ø§Ø³ØªØ¯Ù„Ø§Ù„.                                                                                                                    |
| `wildcardRouter.ts`  | ØªÙˆØ¬ÙŠÙ‡ Ù†Ù…Ø· Ù†Ù…ÙˆØ°Ø¬ Ø­Ø±Ù Ø§Ù„Ø¨Ø¯Ù„: ÙŠØ­Ù„ Ø£Ù†Ù…Ø§Ø· Ø­Ø±Ù Ø§Ù„Ø¨Ø¯Ù„ (Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ØŒ `*/claude-*`) Ù„Ø£Ø²ÙˆØ§Ø¬ Ø§Ù„Ù…ÙˆÙØ±/Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ù„Ù…ÙˆØ³Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙØ± ÙˆØ§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©.                                                                                                                                                       |

#### Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…Ù…ÙŠØ²

```mermaid
sequenceDiagram
    participant R1 as Request 1
    participant R2 as Request 2
    participant Cache as refreshPromiseCache
    participant OAuth as OAuth Provider

    R1->>Cache: getAccessToken("gemini", token)
    Cache->>Cache: No in-flight promise
    Cache->>OAuth: Start refresh
    R2->>Cache: getAccessToken("gemini", token)
    Cache->>Cache: Found in-flight promise
    Cache-->>R2: Return existing promise
    OAuth-->>Cache: New access token
    Cache-->>R1: New access token
    Cache-->>R2: Same access token (shared)
    Cache->>Cache: Delete cache entry
```

#### Ø¢Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù„Ù„Ø­Ø³Ø§Ø¨

```mermaid
stateDiagram-v2
    [*] --> Active
    Active --> Error: Request fails (401/429/500)
    Error --> Cooldown: Apply backoff
    Cooldown --> Active: Cooldown expires
    Active --> Active: Request succeeds (reset backoff)

    state Error {
        [*] --> ClassifyError
        ClassifyError --> ShouldFallback: Rate limit / Auth / Transient
        ClassifyError --> NoFallback: 400 Bad Request
    }

    state Cooldown {
        [*] --> ExponentialBackoff
        ExponentialBackoff: Level 0 = 1s
        ExponentialBackoff: Level 1 = 2s
        ExponentialBackoff: Level 2 = 4s
        ExponentialBackoff: Max = 2min
    }
```

#### Ø³Ù„Ø³Ù„Ø© Ù†Ù…Ø§Ø°Ø¬ ÙƒÙˆÙ…Ø¨Ùˆ

```mermaid
flowchart LR
    A["Request with\ncombo model"] --> B["Model A"]
    B -->|"2xx Success"| C["Return response"]
    B -->|"429/401/500"| D{"Fallback\neligible?"}
    D -->|Yes| E["Model B"]
    D -->|No| F["Return error"]
    E -->|"2xx Success"| C
    E -->|"429/401/500"| G{"Fallback\neligible?"}
    G -->|Yes| H["Model C"]
    G -->|No| F
    H -->|"2xx Success"| C
    H -->|"Fail"| I["All failed â†’\nReturn last status"]
```

---

### Ù…ØªØ±Ø¬Ù… 4.5 (`open-sse/translator/`)

**Ù…Ø­Ø±Ùƒ ØªØ±Ø¬Ù…Ø© Ø§Ù„ØªÙ†Ø³ÙŠÙ‚** Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ø¸Ø§Ù… Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø°Ø§ØªÙŠ.

####Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©

```mermaid
graph TD
    subgraph "Request Translation"
        A["Claude â†’ OpenAI"]
        B["Gemini â†’ OpenAI"]
        C["Antigravity â†’ OpenAI"]
        D["OpenAI Responses â†’ OpenAI"]
        E["OpenAI â†’ Claude"]
        F["OpenAI â†’ Gemini"]
        G["OpenAI â†’ Kiro"]
        H["OpenAI â†’ Cursor"]
    end

    subgraph "Response Translation"
        I["Claude â†’ OpenAI"]
        J["Gemini â†’ OpenAI"]
        K["Kiro â†’ OpenAI"]
        L["Cursor â†’ OpenAI"]
        M["OpenAI â†’ Claude"]
        N["OpenAI â†’ Antigravity"]
        O["OpenAI â†’ Responses"]
    end
```

| Ø§Ù„Ø¯Ù„ÙŠÙ„       | Ù…Ù„ÙØ§Øª     | Ø§Ù„ÙˆØµÙ                                                                                                                                                                                                                                                       |
| ------------ | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `request/`   | 8 Ù…ØªØ±Ø¬Ù…ÙŠÙ† | ØªØ­ÙˆÙŠÙ„ Ø£Ø¬Ø³Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ Ø¨ÙŠÙ† Ø§Ù„ØµÙŠØº. ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ ÙƒÙ„ Ù…Ù„Ù Ø°Ø§ØªÙŠÙ‹Ø§ Ø¹Ø¨Ø± `register(from, to, fn)` Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯.                                                                                                                                                            |
| `response/`  | 7 Ù…ØªØ±Ø¬Ù…ÙŠÙ† | ØªØ­ÙˆÙŠÙ„ Ù‚Ø·Ø¹ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ù…ØªØ¯ÙÙ‚Ø© Ø¨ÙŠÙ† Ø§Ù„ØµÙŠØº. ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø£Ù†ÙˆØ§Ø¹ Ø£Ø­Ø¯Ø§Ø« SSE ÙˆÙƒØªÙ„ Ø§Ù„ØªÙÙƒÙŠØ± ÙˆØ§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª Ø§Ù„Ø£Ø¯ÙˆØ§Øª.                                                                                                                                                          |
| `helpers/`   | 6 Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ† | Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©: `claudeHelper` (Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÙˆØ¬Ù‡ Ø§Ù„Ù†Ø¸Ø§Ù…ØŒ ØªÙƒÙˆÙŠÙ† Ø§Ù„ØªÙÙƒÙŠØ±)ØŒ `geminiHelper` (ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡/Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª)ØŒ `openaiHelper` (ØªØµÙÙŠØ© Ø§Ù„ØªÙ†Ø³ÙŠÙ‚)ØŒ `toolCallHelper` (Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø¹Ø±ÙØŒ Ø­Ù‚Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø©)ØŒ `maxTokensHelper`ØŒ `responsesApiHelper`. |
| `index.ts`   | â€”         | Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ±Ø¬Ù…Ø©: `translateRequest()`ØŒ `translateResponse()`ØŒ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø©ØŒ Ø§Ù„ØªØ³Ø¬ÙŠÙ„.                                                                                                                                                                           |
| `formats.ts` | â€”         | Ø«ÙˆØ§Ø¨Øª Ø§Ù„ØªÙ†Ø³ÙŠÙ‚: `OPENAI`ØŒ `CLAUDE`ØŒ `GEMINI`ØŒ `ANTIGRAVITY`ØŒ `KIRO`ØŒ `CURSOR`ØŒ `OPENAI_RESPONSES`.                                                                                                                                                           |

#### Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø°Ø§ØªÙŠ

```javascript
// Each translator file calls register() on import:
import { register } from "../index.js";
register("claude", "openai", translateClaudeToOpenAI);

// The index.js imports all translator files, triggering registration:
import "./request/claude-to-openai.js"; // â† self-registers
```

---

### 4.6 Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© (`open-sse/utils/`)

| Ù…Ù„Ù                | Ø§Ù„ØºØ±Ø¶                                                                                                                                                                                                                                                                            |
| ------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `error.ts`         | Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø£Ø®Ø·Ø§Ø¡ (ØªÙ†Ø³ÙŠÙ‚ Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ OpenAI)ØŒ ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø£ÙˆÙ„ÙŠØ©ØŒ ÙˆØ§Ø³ØªØ®Ø±Ø§Ø¬ ÙˆÙ‚Øª Ø¥Ø¹Ø§Ø¯Ø© Ù…Ø­Ø§ÙˆÙ„Ø© Antigravity Ù…Ù† Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ØŒ ÙˆØªØ¯ÙÙ‚ Ø£Ø®Ø·Ø§Ø¡ SSE.                                                                                                                                   |
| `stream.ts`        | **SSE Transform Stream** â€” Ø®Ø· Ø£Ù†Ø§Ø¨ÙŠØ¨ Ø§Ù„Ø¨Ø« Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ. ÙˆØ¶Ø¹Ø§Ù†: `TRANSLATE` (ØªØ±Ø¬Ù…Ø© Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„) Ùˆ`PASSTHROUGH` (ØªØ·Ø¨ÙŠØ¹ + Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…). ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª Ù„Ù„Ù‚Ø·Ø¹Ø© ÙˆØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØªØªØ¨Ø¹ Ø·ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰. ØªØªØ¬Ù†Ø¨ Ù…Ø«ÙŠÙ„Ø§Øª ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ´ÙÙŠØ±/ÙˆØ­Ø¯Ø© ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ± Ù„ÙƒÙ„ ØªÙŠØ§Ø± Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©. |
| `streamHelpers.ts` | Ø£Ø¯ÙˆØ§Øª SSE Ø°Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø®ÙØ¶: `parseSSELine` (ØªØªØ­Ù…Ù„ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡)ØŒ `hasValuableContent` (ØªØµÙÙŠØ© Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„ÙØ§Ø±ØºØ© Ù„Ù€ OpenAI/Claude/Gemini)ØŒ `fixInvalidId`ØŒ `formatSSE` (ØªØ³Ù„Ø³Ù„ SSE Ù…Ø¯Ø±Ùƒ Ù„Ù„ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹ ØªÙ†Ø¸ÙŠÙ `perf_metrics`).                                                      |
| `usageTracking.ts` | Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…Ù…ÙŠØ² Ù…Ù† Ø£ÙŠ ØªÙ†Ø³ÙŠÙ‚ (Claude/OpenAI/Gemini/Responses)ØŒ ÙˆØ§Ù„ØªÙ‚Ø¯ÙŠØ± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ø³Ø¨ Ø§Ù„Ø£Ø­Ø±Ù Ù„ÙƒÙ„ Ø±Ù…Ø² Ù…Ù…ÙŠØ² Ù„Ù„Ø£Ø¯Ø§Ø©/Ø§Ù„Ø±Ø³Ø§Ù„Ø©ØŒ ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ù…Ø¤Ù‚Øª (Ù‡Ø§Ù…Ø´ Ø£Ù…Ø§Ù† 2000 Ø±Ù…Ø² Ù…Ù…ÙŠØ²)ØŒ ÙˆØªØµÙÙŠØ© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ØŒ ÙˆØªØ³Ø¬ÙŠÙ„ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø£Ù„ÙˆØ§Ù† ANSI.                              |
| `requestLogger.ts` | ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù„Ù (Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¹Ø¨Ø± `ENABLE_REQUEST_LOGS=true`). ÙŠÙ†Ø´Ø¦ Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© Ø¨Ù…Ù„ÙØ§Øª Ù…Ø±Ù‚Ù…Ø©: `1_req_client.json` â†’ `7_res_client.txt`. ÙƒÙ„ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„/Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬ ØºÙŠØ± Ù…ØªØ²Ø§Ù…Ù†Ø© (Ø£Ø·Ù„Ù‚ Ø§Ù„Ù†Ø§Ø± ÙˆØ§Ù†Ø³Ù‰). Ø£Ù‚Ù†Ø¹Ø© Ø§Ù„Ø±Ø¤ÙˆØ³ Ø§Ù„Ø­Ø³Ø§Ø³Ø©.                                              |
| `bypassHandler.ts` | ÙŠØ¹ØªØ±Ø¶ Ø£Ù†Ù…Ø§Ø·Ù‹Ø§ Ù…Ø­Ø¯Ø¯Ø© Ù…Ù† Claude CLI (Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†ØŒ ÙˆØ§Ù„ØªØ­Ù…ÙŠØ©ØŒ ÙˆØ§Ù„Ø¹Ø¯) ÙˆÙŠØ¹ÙŠØ¯ Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª Ù…Ø²ÙŠÙØ© Ø¯ÙˆÙ† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø£ÙŠ Ù…Ø²ÙˆØ¯. ÙŠØ¯Ø¹Ù… ÙƒÙ„Ø§ Ù…Ù† Ø§Ù„Ø¯ÙÙ‚ ÙˆØºÙŠØ± Ø§Ù„Ø¯ÙÙ‚. ÙŠÙ‚ØªØµØ± Ø¹Ù…Ø¯Ø§ Ø¹Ù„Ù‰ Ù†Ø·Ø§Ù‚ ÙƒÙ„ÙˆØ¯ CLI.                                                                                                      |
| `networkProxy.ts`  | ÙŠØ­Ù„ Ø¹Ù†ÙˆØ§Ù† URL Ù„Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„ØµØ§Ø¯Ø± Ù„Ù…ÙˆÙØ± Ù…Ø¹ÙŠÙ† Ù…Ø¹ Ø§Ù„Ø£Ø³Ø¨Ù‚ÙŠØ©: Ø§Ù„ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…ÙˆÙØ± â†’ Ø§Ù„ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¹Ø§Ù… â†’ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø© (`HTTPS_PROXY`/`HTTP_PROXY`/`ALL_PROXY`). ÙŠØ¯Ø¹Ù… Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª `NO_PROXY`. ØªÙƒÙˆÙŠÙ† Ø°Ø§ÙƒØ±Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª Ù„Ù…Ø¯Ø© 30 Ø«Ø§Ù†ÙŠØ©.                                                        |

#### Ø®Ø· Ø£Ù†Ø§Ø¨ÙŠØ¨ ØªØ¯ÙÙ‚ SSE

```mermaid
flowchart TD
    A["Provider SSE stream"] --> B["TextDecoder\n(per-stream instance)"]
    B --> C["Buffer lines\n(split on newline)"]
    C --> D["parseSSELine()\n(trim whitespace, parse JSON)"]
    D --> E{"Mode?"}
    E -->|TRANSLATE| F["translateResponse()\ntarget â†’ OpenAI â†’ source"]
    E -->|PASSTHROUGH| G["fixInvalidId()\nnormalize chunk"]
    F --> H["hasValuableContent()\nfilter empty chunks"]
    G --> H
    H -->|"Has content"| I["extractUsage()\ntrack token counts"]
    H -->|"Empty"| J["Skip chunk"]
    I --> K["formatSSE()\nserialize + clean perf_metrics"]
    K --> L["TextEncoder\n(per-stream instance)"]
    L --> M["Enqueue to\nclient stream"]

    style A fill:#f9f,stroke:#333
    style M fill:#9f9,stroke:#333
```

#### Ø¨Ù†ÙŠØ© Ø¬Ù„Ø³Ø© Ù…Ø³Ø¬Ù„ Ø§Ù„Ø·Ù„Ø¨

```
logs/
â””â”€â”€ claude_gemini_claude-sonnet_20260208_143045/
    â”œâ”€â”€ 1_req_client.json      â† Raw client request
    â”œâ”€â”€ 2_req_source.json      â† After initial conversion
    â”œâ”€â”€ 3_req_openai.json      â† OpenAI intermediate format
    â”œâ”€â”€ 4_req_target.json      â† Final target format
    â”œâ”€â”€ 5_res_provider.txt     â† Provider SSE chunks (streaming)
    â”œâ”€â”€ 5_res_provider.json    â† Provider response (non-streaming)
    â”œâ”€â”€ 6_res_openai.txt       â† OpenAI intermediate chunks
    â”œâ”€â”€ 7_res_client.txt       â† Client-facing SSE chunks
    â””â”€â”€ 6_error.json           â† Error details (if any)
```

---

### 4.7 Ø·Ø¨Ù‚Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (`src/`)

| Ø§Ù„Ø¯Ù„ÙŠÙ„        | Ø§Ù„ØºØ±Ø¶                                                                                                   |
| ------------- | ------------------------------------------------------------------------------------------------------- |
| `src/app/`    | ÙˆØ§Ø¬Ù‡Ø© Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙˆÙŠØ¨ØŒ Ù…Ø³Ø§Ø±Ø§Øª ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª (API)ØŒ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„ÙˆØ³ÙŠØ·Ø© Ø§Ù„Ø³Ø±ÙŠØ¹Ø©ØŒ Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø±Ø¯ Ø§ØªØµØ§Ù„ OAuth |
| `src/lib/`    | Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (`localDb.ts`ØŒ `usageDb.ts`)ØŒ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©ØŒ Ù…Ø´ØªØ±ÙƒØ©                                |
| `src/mitm/`   | Ø£Ø¯ÙˆØ§Øª Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„ÙˆØ³ÙŠØ· Ù„Ø§Ø¹ØªØ±Ø§Ø¶ Ø­Ø±ÙƒØ© Ù…Ø±ÙˆØ± Ø§Ù„Ù…ÙˆÙØ±                                                     |
| `src/models/` | ØªØ¹Ø±ÙŠÙØ§Øª Ù†Ù…Ø§Ø°Ø¬ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª                                                                            |
| `src/shared/` | Ø£ØºÙ„ÙØ© Ø­ÙˆÙ„ ÙˆØ¸Ø§Ø¦Ù open-sse (Ø§Ù„Ù…Ø²ÙˆØ¯ØŒ Ø§Ù„Ø¯ÙÙ‚ØŒ Ø§Ù„Ø®Ø·Ø£ØŒ Ø¥Ù„Ø®)                                                    |
| `src/sse/`    | Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© SSE Ø§Ù„ØªÙŠ ØªØ±Ø¨Ø· Ù…ÙƒØªØ¨Ø© open-sse Ø¨Ù…Ø³Ø§Ø±Ø§Øª Express                                         |
| `src/store/`  | Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚                                                                                      |

#### Ù…Ø³Ø§Ø±Ø§Øª API Ø§Ù„Ø¨Ø§Ø±Ø²Ø©

| Ø§Ù„Ø·Ø±ÙŠÙ‚                                        | Ø·Ø±Ù‚                | Ø§Ù„ØºØ±Ø¶                                                                          |
| --------------------------------------------- | ------------------ | ------------------------------------------------------------------------------ |
| `/api/provider-models`                        | Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰/Ù†Ø´Ø±/Ø­Ø°Ù | CRUD Ù„Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù…Ø®ØµØµØ© Ù„ÙƒÙ„ Ù…Ø²ÙˆØ¯                                                  |
| `/api/models/catalog`                         | Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰           | ÙƒØªØ§Ù„ÙˆØ¬ Ù…Ø¬Ù…Ø¹ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ (Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©ØŒ Ø§Ù„ØªØ¶Ù…ÙŠÙ†ØŒ Ø§Ù„ØµÙˆØ±Ø©ØŒ Ø§Ù„Ù…Ø®ØµØµØ©) Ù…Ø¬Ù…Ø¹Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆÙØ± |
| `/api/settings/proxy`                         | Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰/ÙˆØ¶Ø¹/Ø­Ø°Ù | ØªÙƒÙˆÙŠÙ† Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„ØµØ§Ø¯Ø± Ø§Ù„Ù‡Ø±Ù…ÙŠ (`global/providers/combos/keys`)                    |
| `/api/settings/proxy/test`                    | Ù…Ø´Ø§Ø±ÙƒØ©             | Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§ØªØµØ§Ù„ Ø§Ù„ÙˆÙƒÙŠÙ„ ÙˆØ¥Ø±Ø¬Ø§Ø¹ IP/Ø²Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø¹Ø§Ù…                          |
| `/v1/providers/[provider]/chat/completions`   | Ù…Ø´Ø§Ø±ÙƒØ©             | Ø¹Ù…Ù„ÙŠØ§Øª Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ù…Ø®ØµØµØ© Ù„ÙƒÙ„ Ù…Ø²ÙˆØ¯ Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬                 |
| `/v1/providers/[provider]/embeddings`         | Ù…Ø´Ø§Ø±ÙƒØ©             | Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ù…Ø®ØµØµØ© Ù„ÙƒÙ„ Ù…Ø²ÙˆØ¯ Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬                       |
| `/v1/providers/[provider]/images/generations` | Ù…Ø´Ø§Ø±ÙƒØ©             | Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØ± Ù…Ø®ØµØµØ© Ù„ÙƒÙ„ Ù…Ø²ÙˆØ¯ Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬                              |
| `/api/settings/ip-filter`                     | Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰/ÙˆØ¶Ø¹     | Ù‚Ø§Ø¦Ù…Ø© IP Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§/Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø¸ÙˆØ±Ø©                                    |
| `/api/settings/thinking-budget`               | Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰/ÙˆØ¶Ø¹     | ØªÙƒÙˆÙŠÙ† Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…Ù…ÙŠØ² (Ø§Ù„Ø¹Ø¨ÙˆØ±/Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ/Ø§Ù„Ù…Ø®ØµØµ/Ø§Ù„ØªÙƒÙŠÙÙŠ)                    |
| `/api/settings/system-prompt`                 | Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰/ÙˆØ¶Ø¹     | Ø§Ù„Ø­Ù‚Ù† Ø§Ù„ÙÙˆØ±ÙŠ Ù„Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª                                      |
| `/api/sessions`                               | Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰           | ØªØªØ¨Ø¹ Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ù†Ø´Ø·Ø© ÙˆÙ…Ù‚Ø§ÙŠÙŠØ³Ù‡Ø§                                                   |
| `/api/rate-limits`                            | Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰           | Ø­Ø§Ù„Ø© Ø­Ø¯ Ø§Ù„Ù…Ø¹Ø¯Ù„ Ù„ÙƒÙ„ Ø­Ø³Ø§Ø¨                                                        |

---

## 5. Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

### 5.1 Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø­ÙˆØ±ÙŠØ© ÙˆØ§Ù„Ù…ØªØ­Ø¯Ø«Ø©

ØªØªÙ… ØªØ±Ø¬Ù…Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ù…Ù† Ø®Ù„Ø§Ù„ **ØªÙ†Ø³ÙŠÙ‚ OpenAI ÙƒÙ…Ø­ÙˆØ±**. Ù„Ø§ ØªØªØ·Ù„Ø¨ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆÙØ± Ø¬Ø¯ÙŠØ¯ Ø³ÙˆÙ‰ ÙƒØªØ§Ø¨Ø© **Ø²ÙˆØ¬ ÙˆØ§Ø­Ø¯** Ù…Ù† Ø§Ù„Ù…ØªØ±Ø¬Ù…ÙŠÙ† (Ù…Ù†/Ø¥Ù„Ù‰ OpenAI)ØŒ ÙˆÙ„ÙŠØ³ Ø¹Ø¯Ø¯ N Ù…Ù† Ø§Ù„Ù…ØªØ±Ø¬Ù…ÙŠÙ†.

### 5.2 Ù†Ù…Ø· Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ù…Ù†ÙØ°

ÙƒÙ„ Ù…Ø²ÙˆØ¯ Ù„Ø¯ÙŠÙ‡ ÙØ¦Ø© Ù…Ù†ÙØ°Ø© Ù…Ø®ØµØµØ© ØªØ±Ø« Ù…Ù† `BaseExecutor`. ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù…ØµÙ†Ø¹ ÙÙŠ `executors/index.ts` Ø¨Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ØµÙ†Ø¹ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ ÙÙŠ ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„.

### 5.3 Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ù„Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø°Ø§ØªÙŠ

ØªØ³Ø¬Ù„ ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ù…ØªØ±Ø¬Ù… Ù†ÙØ³Ù‡Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¹Ø¨Ø± `register()`. Ø¥Ù† Ø¥Ø¶Ø§ÙØ© Ù…ØªØ±Ø¬Ù… Ø¬Ø¯ÙŠØ¯ ÙŠØ¹Ù†ÙŠ Ù…Ø¬Ø±Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù ÙˆØ§Ø³ØªÙŠØ±Ø§Ø¯Ù‡.

### 5.4 Ø§Ù„ØªØ±Ø§Ø¬Ø¹ ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…Ø¹ Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø§Ù„Ø£Ø³ÙŠ

Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙ‚ÙˆÙ… Ù…Ù‚Ø¯Ù… Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ø¥Ø±Ø¬Ø§Ø¹ 429/401/500ØŒ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ§Ù„ÙŠØŒ Ù…Ø¹ ØªØ·Ø¨ÙŠÙ‚ ÙØªØ±Ø§Øª Ø§Ù„ØªØ¨Ø§Ø·Ø¤ Ø§Ù„Ø£Ø³ÙŠØ© (1Ø« â†’ 2Ø« â†’ 4Ø« â†’ 2 Ø¯Ù‚ÙŠÙ‚Ø© ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰).

### 5.5 Ø³Ù„Ø§Ø³Ù„ Ù†Ù…Ø§Ø°Ø¬ ÙƒÙˆÙ…Ø¨Ùˆ

ÙŠÙ‚ÙˆÙ… "Ø§Ù„ØªØ­Ø±ÙŠØ± ÙˆØ§Ù„Ø³Ø±Ø¯" Ø¨ØªØ¬Ù…ÙŠØ¹ Ø³Ù„Ø§Ø³Ù„ `provider/model` Ù…ØªØ¹Ø¯Ø¯Ø©. Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ø£ÙˆÙ„ØŒ ÙŠØªÙ… Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„ØªØ§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.

### 5.6 ØªØ±Ø¬Ù…Ø© Ù…ØªØ¯ÙÙ‚Ø© Ø±Ø§Ø¦Ø¹Ø©

ØªØ­Ø§ÙØ¸ ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§Ù„Ø© Ø¹Ø¨Ø± Ø£Ø¬Ø²Ø§Ø¡ SSE (ØªØªØ¨Ø¹ ÙƒØªÙ„Ø© Ø§Ù„ØªÙÙƒÙŠØ±ØŒ ÙˆØªØ±Ø§ÙƒÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø©ØŒ ÙˆÙÙ‡Ø±Ø³Ø© ÙƒØªÙ„Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰) Ø¹Ø¨Ø± Ø¢Ù„ÙŠØ© `initState()`.

### 5.7 Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ù…Ø¤Ù‚Øª Ù„Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

ØªØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø®Ø²Ù† Ù…Ø¤Ù‚Øª Ù…ÙƒÙˆÙ† Ù…Ù† 2000 Ø±Ù…Ø² Ù…Ù…ÙŠØ² Ø¥Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø¨Ù„Øº Ø¹Ù†Ù‡ Ù„Ù…Ù†Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø­Ø¯ÙˆØ¯ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø³ÙŠØ§Ù‚ Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ø­Ù…Ù„ Ø§Ù„Ø²Ø§Ø¦Ø¯ Ù…Ù† Ù…Ø·Ø§Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØªØ±Ø¬Ù…Ø© Ø§Ù„ØªÙ†Ø³ÙŠÙ‚.

---

## 6. Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©

| ØªÙ†Ø³ÙŠÙ‚                               | Ø§Ù„Ø§ØªØ¬Ø§Ù‡        | Ø§Ù„Ù…Ø¹Ø±Ù             |
| ----------------------------------- | -------------- | ------------------ |
| Ø§Ø³ØªÙƒÙ…Ø§Ù„Ø§Øª Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© OpenAI            | Ø§Ù„Ù…ØµØ¯Ø± + Ø§Ù„Ù‡Ø¯Ù | `openai`           |
| ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª OpenAI | Ø§Ù„Ù…ØµØ¯Ø± + Ø§Ù„Ù‡Ø¯Ù | `openai-responses` |
| Ø£Ù†Ø«Ø±ÙˆØ¨ÙŠ ÙƒÙ„ÙˆØ¯                        | Ø§Ù„Ù…ØµØ¯Ø± + Ø§Ù„Ù‡Ø¯Ù | `claude`           |
| Ø¬ÙˆØ¬Ù„ Ø§Ù„Ø¬ÙˆØ²Ø§Ø¡                        | Ø§Ù„Ù…ØµØ¯Ø± + Ø§Ù„Ù‡Ø¯Ù | `gemini`           |
| Ø¬ÙˆØ¬Ù„ Ø§Ù„Ø¬ÙˆØ²Ø§Ø¡ CLI                    | Ø§Ù„Ù‡Ø¯Ù ÙÙ‚Ø·      | `gemini-cli`       |
| Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ©                     | Ø§Ù„Ù…ØµØ¯Ø± + Ø§Ù„Ù‡Ø¯Ù | `antigravity`      |
| Ø£ÙˆØ³ ÙƒÙŠØ±Ùˆ                            | Ø§Ù„Ù‡Ø¯Ù ÙÙ‚Ø·      | `kiro`             |
| Ø§Ù„Ù…Ø¤Ø´Ø±                              | Ø§Ù„Ù‡Ø¯Ù ÙÙ‚Ø·      | `cursor`           |

---

## 7. Ù…Ù‚Ø¯Ù…Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…ÙŠÙ†

| Ù…Ù‚Ø¯Ù…                      | Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©           | Ø§Ù„Ù…Ù†ÙØ°          | Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©                                        |
| ------------------------- | ------------------------ | --------------- | --------------------------------------------------------- |
| Ø£Ù†Ø«Ø±ÙˆØ¨ÙŠ ÙƒÙ„ÙˆØ¯              | Ù…ÙØªØ§Ø­ API Ø£Ùˆ OAuth       | Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ       | ÙŠØ³ØªØ®Ø¯Ù… Ø±Ø£Ø³ `x-api-key`                                    |
| Ø¬ÙˆØ¬Ù„ Ø§Ù„Ø¬ÙˆØ²Ø§Ø¡              | Ù…ÙØªØ§Ø­ API Ø£Ùˆ OAuth       | Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ       | ÙŠØ³ØªØ®Ø¯Ù… Ø±Ø£Ø³ `x-goog-api-key`                               |
| Ø¬ÙˆØ¬Ù„ Ø§Ù„Ø¬ÙˆØ²Ø§Ø¡ CLI          | Ø£ÙˆÙˆØ«                     | Ø§Ù„Ø¬ÙˆØ²Ø§Ø¡ ÙƒÙ„ÙŠ     | ÙŠØ³ØªØ®Ø¯Ù… `streamGenerateContent` Ù†Ù‚Ø·Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ©               |
| Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ©           | Ø£ÙˆÙˆØ«                     | Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© | Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø¹Ù†Ø§ÙˆÙŠÙ† URL Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©ØŒ Ø¥Ø¹Ø§Ø¯Ø© Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®ØµØµØ© |
| Ø£ÙˆØ¨Ù† Ø¢ÙŠ                   | Ù…ÙØªØ§Ø­ API                | Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ       | Ù…ØµØ§Ø¯Ù‚Ø© Ø­Ø§Ù…Ù„ Ø§Ù„Ù…Ø¹ÙŠØ§Ø±                                       |
| Ø§Ù„Ø¯Ø³ØªÙˆØ± Ø§Ù„ØºØ°Ø§Ø¦ÙŠ           | Ø£ÙˆÙˆØ«                     | Ø§Ù„Ø¯Ø³ØªÙˆØ± Ø§Ù„ØºØ°Ø§Ø¦ÙŠ | ÙŠØ¯Ø®Ù„ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆÙŠØ¯ÙŠØ± Ø§Ù„ØªÙÙƒÙŠØ±                         |
| Ø¬ÙŠØ«Ø¨ Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø·ÙŠØ§Ø±         | OAuth + Ø±Ù…Ø² Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø·ÙŠØ§Ø± | Ø¬ÙŠØ«Ø¨            | Ø±Ù…Ø² Ù…Ø²Ø¯ÙˆØ¬ØŒ Ù…Ø­Ø§ÙƒØ§Ø© Ø±Ø£Ø³ VSCode                              |
| ÙƒÙŠØ±Ùˆ (AWS)                | AWS SSO OIDC Ø£Ùˆ Social   | ÙƒÙŠØ±Ùˆ            | ØªØ­Ù„ÙŠÙ„ Ø¯ÙÙ‚ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠØ©                                |
| Ø¨ÙŠØ¦Ø© ØªØ·ÙˆÙŠØ± Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù…Ø¤Ø´Ø± | Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ÙŠ | Ø§Ù„Ù…Ø¤Ø´Ø±          | ØªØ±Ù…ÙŠØ² ProtobufØŒ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ÙŠ SHA-256                 |
| ÙƒÙˆÙŠÙ†                      | Ø£ÙˆÙˆØ«                     | Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ       | Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ©                                         |
| Ø§ÙŠ ÙÙ„Ùˆ                    | OAuth (Ø£Ø³Ø§Ø³ÙŠ + Ø­Ø§Ù…Ù„)     | Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ       | Ø±Ø£Ø³ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬Ø©                                     |
| Ø§ÙˆØ¨Ù† Ø±Ø§ÙˆØªØ±                | Ù…ÙØªØ§Ø­ API                | Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ       | Ù…ØµØ§Ø¯Ù‚Ø© Ø­Ø§Ù…Ù„ Ø§Ù„Ù…Ø¹ÙŠØ§Ø±                                       |
| Ø¬ÙŠ Ø¥Ù„ Ø¥Ù…ØŒ ÙƒÙŠÙ…ÙŠØŒ Ù…ÙŠÙ†ÙŠ Ù…Ø§ÙƒØ³ | Ù…ÙØªØ§Ø­ API                | Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ       | Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ ÙƒÙ„ÙˆØ¯ØŒ Ø§Ø³ØªØ®Ø¯Ù… `x-api-key`                        |
| `openai-compatible-*`     | Ù…ÙØªØ§Ø­ API                | Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ       | Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ: Ø£ÙŠ Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ OpenAI                 |
| `anthropic-compatible-*`  | Ù…ÙØªØ§Ø­ API                | Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ       | Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ: Ø£ÙŠ Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ ÙƒÙ„ÙˆØ¯                   |

---

## 8. Ù…Ù„Ø®Øµ ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

### Ø·Ù„Ø¨ Ø§Ù„Ø¨Ø«

```mermaid
flowchart LR
    A["Client"] --> B["detectFormat()"]
    B --> C["translateRequest()\nsource â†’ OpenAI â†’ target"]
    C --> D["Executor\nbuildUrl + buildHeaders"]
    D --> E["fetch(providerURL)"]
    E --> F["createSSEStream()\nTRANSLATE mode"]
    F --> G["parseSSELine()"]
    G --> H["translateResponse()\ntarget â†’ OpenAI â†’ source"]
    H --> I["extractUsage()\n+ addBuffer"]
    I --> J["formatSSE()"]
    J --> K["Client receives\ntranslated SSE"]
    K --> L["logUsage()\nsaveRequestUsage()"]
```

### Ø·Ù„Ø¨ Ø¹Ø¯Ù… Ø§Ù„Ø¨Ø«

```mermaid
flowchart LR
    A["Client"] --> B["detectFormat()"]
    B --> C["translateRequest()\nsource â†’ OpenAI â†’ target"]
    C --> D["Executor.execute()"]
    D --> E["translateResponse()\ntarget â†’ OpenAI â†’ source"]
    E --> F["Return JSON\nresponse"]
```

### ØªØ¬Ø§ÙˆØ² Ø§Ù„ØªØ¯ÙÙ‚ (ÙƒÙ„ÙˆØ¯ CLI)

```mermaid
flowchart LR
    A["Claude CLI request"] --> B{"Match bypass\npattern?"}
    B -->|"Title/Warmup/Count"| C["Generate fake\nOpenAI response"]
    B -->|"No match"| D["Normal flow"]
    C --> E["Translate to\nsource format"]
    E --> F["Return without\ncalling provider"]
```
