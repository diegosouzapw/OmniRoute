# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ OmniRoute

üåê **Languages:** üá∫üá∏ [English](../../ARCHITECTURE.md) | üáßüá∑ [Portugu√™s (Brasil)](../pt-BR/ARCHITECTURE.md) | üá™üá∏ [Espa√±ol](../es/ARCHITECTURE.md) | üá´üá∑ [Fran√ßais](../fr/ARCHITECTURE.md) | üáÆüáπ [Italiano](../it/ARCHITECTURE.md) | üá∑üá∫ [–†—É—Å—Å–∫–∏–π](../ru/ARCHITECTURE.md) | üá®üá≥ [‰∏≠Êñá (ÁÆÄ‰Ωì)](../zh-CN/ARCHITECTURE.md) | üá©üá™ [Deutsch](../de/ARCHITECTURE.md) | üáÆüá≥ [‡§π‡§ø‡§®‡•ç‡§¶‡•Ä](../in/ARCHITECTURE.md) | üáπüá≠ [‡πÑ‡∏ó‡∏¢](../th/ARCHITECTURE.md) | üá∫üá¶ [–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞](../uk-UA/ARCHITECTURE.md) | üá∏üá¶ [ÿßŸÑÿπÿ±ÿ®Ÿäÿ©](../ar/ARCHITECTURE.md) | üáØüáµ [Êó•Êú¨Ë™û](../ja/ARCHITECTURE.md) | üáªüá≥ [Ti·∫øng Vi·ªát](../vi/ARCHITECTURE.md) | üáßüá¨ [–ë—ä–ª–≥–∞—Ä—Å–∫–∏](../bg/ARCHITECTURE.md) | üá©üá∞ [Dansk](../da/ARCHITECTURE.md) | üá´üáÆ [Suomi](../fi/ARCHITECTURE.md) | üáÆüá± [◊¢◊ë◊®◊ô◊™](../he/ARCHITECTURE.md) | üá≠üá∫ [Magyar](../hu/ARCHITECTURE.md) | üáÆüá© [Bahasa Indonesia](../id/ARCHITECTURE.md) | üá∞üá∑ [ÌïúÍµ≠Ïñ¥](../ko/ARCHITECTURE.md) | üá≤üáæ [Bahasa Melayu](../ms/ARCHITECTURE.md) | üá≥üá± [Nederlands](../nl/ARCHITECTURE.md) | üá≥üá¥ [Norsk](../no/ARCHITECTURE.md) | üáµüáπ [Portugu√™s (Portugal)](../pt/ARCHITECTURE.md) | üá∑üá¥ [Rom√¢nƒÉ](../ro/ARCHITECTURE.md) | üáµüá± [Polski](../pl/ARCHITECTURE.md) | üá∏üá∞ [Slovenƒçina](../sk/ARCHITECTURE.md) | üá∏üá™ [Svenska](../sv/ARCHITECTURE.md) | üáµüá≠ [Filipino](../phi/ARCHITECTURE.md)

_–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 18 —Ñ–µ–≤—Ä–∞–ª—è 2026 –≥._

## –†–µ–∑—é–º–µ

OmniRoute ‚Äî —ç—Ç–æ –ª–æ–∫–∞–ª—å–Ω—ã–π —à–ª—é–∑ –∏ –ø–∞–Ω–µ–ª—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ AI, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ Next.js.
–û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–¥–∏–Ω—É—é –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫—É, —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é —Å OpenAI (`/v1/*`), –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤—ã—à–µ—Å—Ç–æ—è—â–∏–º–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏ —Å —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–µ–π, —Ä–µ–∑–µ—Ä–≤–Ω—ã–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Ç–æ–∫–µ–Ω–∞ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å API –¥–ª—è CLI/–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (28 –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤)
- –¢—Ä–∞–Ω—Å–ª—è—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞/–æ—Ç–≤–µ—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–∞—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.
- –†–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∫–æ–º–±–æ-–º–æ–¥–µ–ª–∏ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π)
- –†–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ (–Ω–µ—Å–∫–æ–ª—å–∫–æ —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ø–æ—Å—Ç–∞–≤—â–∏–∫—É OAuth + API-–∫–ª—é—á–µ–π
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ `/v1/embeddings` (6 –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤, 9 –º–æ–¥–µ–ª–µ–π)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ `/v1/images/generations` (4 –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞, 9 –º–æ–¥–µ–ª–µ–π)
- –ü–æ–¥—É–º–∞–π—Ç–µ –æ —Ä–∞–∑–±–æ—Ä–µ —Ç–µ–≥–æ–≤ (`<think>...</think>`) –¥–ª—è –º–æ–¥–µ–ª–µ–π —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π.
- –û—á–∏—Å—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è —Å—Ç—Ä–æ–≥–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ OpenAI SDK.
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ–ª–µ–π (—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫‚Üí—Å–∏—Å—Ç–µ–º–∞, —Å–∏—Å—Ç–µ–º–∞‚Üí–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏.
- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ (json_schema ‚Üí Gemini responseSchema)
- –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤, –∫–ª—é—á–µ–π, –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–≤, –∫–æ–º–±–∏–Ω–∞—Ü–∏–π, –Ω–∞—Å—Ç—Ä–æ–µ–∫, —Ü–µ–Ω.
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è/—Ä–∞—Å—Ö–æ–¥–æ–≤ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–±–ª–∞—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤/—Å–æ—Å—Ç–æ—è–Ω–∏–π.
- –°–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö/–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ API.
- –ü—Ä–æ–¥—É–º–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–æ–º (—Å–∫–≤–æ–∑–Ω–æ–µ/–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ/–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ/–∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ)
- –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–µ–∞–Ω—Å–æ–≤ –∏ —Å–Ω—è—Ç–∏–µ –æ—Ç–ø–µ—á–∞—Ç–∫–æ–≤ –ø–∞–ª—å—Ü–µ–≤
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ—Ñ–∏–ª–µ–π –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞.
- –°—Ö–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—è –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
- –ê–Ω—Ç–∏-–≥—Ä–æ–º–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ —Å—Ç–∞–¥–∞ —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π –º—å—é—Ç–µ–∫—Å–∞
- –ö—ç—à –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏–≥–Ω–∞—Ç—É—Ä.
- –£—Ä–æ–≤–µ–Ω—å –¥–æ–º–µ–Ω–∞: –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏, –ø—Ä–∞–≤–∏–ª–∞ –∑–∞—Ç—Ä–∞—Ç, —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞, –ø–æ–ª–∏—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–æ–º–µ–Ω–∞ (–∫—ç—à —Å–∫–≤–æ–∑–Ω–æ–π –∑–∞–ø–∏—Å–∏ SQLite –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π, –±—é–¥–∂–µ—Ç–æ–≤, –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π)
- –ú–µ—Ö–∞–Ω–∏–∑–º –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ ‚Üí –±—é–¥–∂–µ—Ç ‚Üí —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)
- –ó–∞–ø—Ä–æ—Å —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ —Å –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π –∑–∞–¥–µ—Ä–∂–µ–∫ p50/p95/p99.
- –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (X-Request-Id) –¥–ª—è —Å–∫–≤–æ–∑–Ω–æ–π —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏.
- –í–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ –∞—É–¥–∏—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ç–∫–∞–∑–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª—é—á–∞ API.
- –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ LLM
- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
- –ú–æ–¥—É–ª—å–Ω—ã–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏ OAuth (12 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π –ø–æ–¥ `src/lib/oauth/providers/`)

–û—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

- –ú–∞—Ä—à—Ä—É—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π Next.js –≤ `src/app/api/*` —Ä–µ–∞–ª–∏–∑—É—é—Ç –∫–∞–∫ API –ø–∞–Ω–µ–ª–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, —Ç–∞–∫ –∏ API —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.
- –û–±—â–µ–µ —è–¥—Ä–æ SSE/–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –≤ `src/sse/*` + `open-sse/*` —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞, —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–µ–π, –ø–æ—Ç–æ–∫–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–µ–π, —Ä–µ–∑–µ—Ä–≤–Ω—ã–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º.

## –û–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏ –≥—Ä–∞–Ω–∏—Ü—ã

### –í –æ–±—ä–µ–º–µ

- –°—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —à–ª—é–∑–∞
- API-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–∞–Ω–µ–ª—å—é
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- –ó–∞–ø—Ä–æ—Å–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –∏ –ø–æ—Ç–æ–∫–æ–≤—É—é –ø–µ—Ä–µ–¥–∞—á—É SSE
- –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ + –ø–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ä–∫–µ—Å—Ç—Ä–æ–≤–∫–∞ –æ–±–ª–∞—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

### –í—ã—Ö–æ–¥–∏—Ç –∑–∞ —Ä–∞–º–∫–∏

- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±–ª–∞—á–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ –±–∞–∑–µ `NEXT_PUBLIC_CLOUD_URL`.
- –°–æ–≥–ª–∞—à–µ–Ω–∏–µ –æ–± —É—Ä–æ–≤–Ω–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞/–ø–ª–æ—Å–∫–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–Ω–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.
- –°–∞–º–∏ –≤–Ω–µ—à–Ω–∏–µ –¥–≤–æ–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã CLI (Claude CLI, Codex CLI –∏ —Ç.¬†–¥.)

## –°–∏—Å—Ç–µ–º–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è

```mermaid
flowchart LR
    subgraph Clients[Developer Clients]
        C1[Claude Code]
        C2[Codex CLI]
        C3[OpenClaw / Droid / Cline / Continue / Roo]
        C4[Custom OpenAI-compatible clients]
        BROWSER[Browser Dashboard]
    end

    subgraph Router[OmniRoute Local Process]
        API[V1 Compatibility API\n/v1/*]
        DASH[Dashboard + Management API\n/api/*]
        CORE[SSE + Translation Core\nopen-sse + src/sse]
        DB[(db.json)]
        UDB[(usage.json + log.txt)]
    end

    subgraph Upstreams[Upstream Providers]
        P1[OAuth Providers\nClaude/Codex/Gemini/Qwen/iFlow/GitHub/Kiro/Cursor/Antigravity]
        P2[API Key Providers\nOpenAI/Anthropic/OpenRouter/GLM/Kimi/MiniMax\nDeepSeek/Groq/xAI/Mistral/Perplexity\nTogether/Fireworks/Cerebras/Cohere/NVIDIA]
        P3[Compatible Nodes\nOpenAI-compatible / Anthropic-compatible]
    end

    subgraph Cloud[Optional Cloud Sync]
        CLOUD[Cloud Sync Endpoint\nNEXT_PUBLIC_CLOUD_URL]
    end

    C1 --> API
    C2 --> API
    C3 --> API
    C4 --> API
    BROWSER --> DASH

    API --> CORE
    DASH --> DB
    CORE --> DB
    CORE --> UDB

    CORE --> P1
    CORE --> P2
    CORE --> P3

    DASH --> CLOUD
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ä–µ–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

## 1) API –∏ —É—Ä–æ–≤–µ–Ω—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ (–º–∞—Ä—à—Ä—É—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π Next.js)

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏:

- `src/app/api/v1/*` –∏ `src/app/api/v1beta/*` –¥–ª—è API —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.
- `src/app/api/*` –¥–ª—è API —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è/–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
- –î–∞–ª–µ–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç `next.config.mjs` —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç `/v1/*` —Å `/api/v1/*`.

–í–∞–∂–Ω—ã–µ –ø—É—Ç–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:

- `src/app/api/v1/chat/completions/route.ts`
- `src/app/api/v1/messages/route.ts`
- `src/app/api/v1/responses/route.ts`
- `src/app/api/v1/models/route.ts` ‚Äî –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ —Å `custom: true`.
- `src/app/api/v1/embeddings/route.ts` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è (6 –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤)
- `src/app/api/v1/images/generations/route.ts` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (4+ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞, –≤–∫–ª—é—á–∞—è –ê–Ω—Ç–∏–≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è/–ù–µ–±–∏—É—Å)
- `src/app/api/v1/messages/count_tokens/route.ts`
- `src/app/api/v1/providers/[provider]/chat/completions/route.ts` ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π —á–∞—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- `src/app/api/v1/providers/[provider]/embeddings/route.ts` ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.
- `src/app/api/v1/providers/[provider]/images/generations/route.ts` ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞.
- `src/app/api/v1beta/models/route.ts`
- `src/app/api/v1beta/models/[...path]/route.ts`

–î–æ–º–µ–Ω—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è/–Ω–∞—Å—Ç—Ä–æ–π–∫–∏: `src/app/api/auth/*`, `src/app/api/settings/*`.
- –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã/—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: `src/app/api/providers*`
- –£–∑–ª—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞: `src/app/api/provider-nodes*`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–æ–¥–µ–ª–∏: `src/app/api/provider-models` (GET/POST/DELETE)
- –ö–∞—Ç–∞–ª–æ–≥ –º–æ–¥–µ–ª–µ–π: `src/app/api/models/catalog` (GET)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏: `src/app/api/settings/proxy` (GET/PUT/DELETE) + `src/app/api/settings/proxy/test` (POST)
- OAuth: `src/app/api/oauth/*`
- –ö–ª—é—á–∏/–ø—Å–µ–≤–¥–æ–Ω–∏–º—ã/–∫–æ–º–±–æ/—Ü–µ–Ω—ã: `src/app/api/keys*`, `src/app/api/models/alias`, `src/app/api/combos*`, `src/app/api/pricing`.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: `src/app/api/usage/*`
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è/–æ–±–ª–∞–∫–æ: `src/app/api/sync/*`, `src/app/api/cloud/*`
- –ü–æ–º–æ—â–Ω–∏–∫–∏ –ø–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º CLI: `src/app/api/cli-tools/*`.
- IP-—Ñ–∏–ª—å—Ç—Ä: `src/app/api/settings/ip-filter` (GET/PUT)
- –ú—ã—Å–ª–µ–Ω–Ω—ã–π –±—é–¥–∂–µ—Ç: `src/app/api/settings/thinking-budget` (GET/PUT)
- –°–∏—Å—Ç–µ–º–Ω–æ–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ: `src/app/api/settings/system-prompt` (GET/PUT)
- –°–µ—Å—Å–∏–∏: `src/app/api/sessions` (GET)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏: `src/app/api/rate-limits` (GET)
- –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å: `src/app/api/resilience` (GET/PATCH) ‚Äî –ø—Ä–æ—Ñ–∏–ª–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—å, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏.
- –°–±—Ä–æ—Å —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏: `src/app/api/resilience/reset` (POST) ‚Äî —Å–±—Ä–æ—Å –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π + –∫—É–ª–¥–∞—É–Ω–æ–≤.
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞: `src/app/api/cache/stats` (GET/DELETE)
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏: `src/app/api/models/availability` (GET/POST)
- –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è: `src/app/api/telemetry/summary` (GET)
- –ë—é–¥–∂–µ—Ç: `src/app/api/usage/budget` (GET/POST)
- –†–µ–∑–µ—Ä–≤–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏: `src/app/api/fallback/chains` (GET/POST/DELETE)
- –ê—É–¥–∏—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è: `src/app/api/compliance/audit-log` (GET)
- –û—Ü–µ–Ω–∫–∏: `src/app/api/evals` (GET/POST), `src/app/api/evals/[suiteId]` (GET)
- –ü–æ–ª–∏—Ç–∏–∫–∏: `src/app/api/policies` (GET/POST)

## 2) SSE + —è–¥—Ä–æ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏

–ú–æ–¥—É–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞:

- –ó–∞–ø–∏—Å—å: `src/sse/handlers/chat.ts`
- –ë–∞–∑–æ–≤–∞—è –æ—Ä–∫–µ—Å—Ç—Ä–æ–≤–∫–∞: `open-sse/handlers/chatCore.ts`.
- –ê–¥–∞–ø—Ç–µ—Ä—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞: `open-sse/executors/*`
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∞/–ø–æ—Å—Ç–∞–≤—â–∏–∫–∞: `open-sse/services/provider.ts`
- –ê–Ω–∞–ª–∏–∑/—Ä–µ—à–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏: `src/sse/services/model.ts`, `open-sse/services/model.ts`.
- –õ–æ–≥–∏–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏: `open-sse/services/accountFallback.ts`.
- –†–µ–µ—Å—Ç—Ä –ø–µ—Ä–µ–≤–æ–¥–æ–≤: `open-sse/translator/index.ts`
- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ—Ç–æ–∫–∞: `open-sse/utils/stream.ts`, `open-sse/utils/streamHandler.ts`.
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ/–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: `open-sse/utils/usageTracking.ts`
- –ü–æ–¥—É–º–∞–π—Ç–µ –æ –ø–∞—Ä—Å–µ—Ä–µ —Ç–µ–≥–æ–≤: `open-sse/utils/thinkTagParser.ts`.
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è: `open-sse/handlers/embeddings.ts`
- –†–µ–µ—Å—Ç—Ä –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è: `open-sse/config/embeddingRegistry.ts`.
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: `open-sse/handlers/imageGeneration.ts`
- –†–µ–µ—Å—Ç—Ä –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: `open-sse/config/imageRegistry.ts`.
- –û–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞: `open-sse/handlers/responseSanitizer.ts`.
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ–ª–µ–π: `open-sse/services/roleNormalizer.ts`

–°–µ—Ä–≤–∏—Å—ã (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞):

- –í—ã–±–æ—Ä/–æ—Ü–µ–Ω–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞: `open-sse/services/accountSelector.ts`
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: `open-sse/services/contextManager.ts`.
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ IP-—Ñ–∏–ª—å—Ç—Ä–∞: `open-sse/services/ipFilter.ts`.
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–µ–∞–Ω—Å–∞: `open-sse/services/sessionManager.ts`
- –ó–∞–ø—Ä–æ—Å –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏: `open-sse/services/signatureCache.ts`
- –ü–æ–¥—Å–∫–∞–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã: `open-sse/services/systemPrompt.ts`
- –ú—ã—à–ª–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—é–¥–∂–µ—Ç–æ–º: `open-sse/services/thinkingBudget.ts`
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ —Å –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–º–∏ –∑–Ω–∞–∫–∞–º–∏: `open-sse/services/wildcardRouter.ts`.
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–º —Å–∫–æ—Ä–æ—Å—Ç–∏: `open-sse/services/rateLimitManager.ts`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—å: `open-sse/services/circuitBreaker.ts`

–ú–æ–¥—É–ª–∏ –¥–æ–º–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è:

- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏: `src/lib/domain/modelAvailability.ts`
  ‚Äì –ü—Ä–∞–≤–∏–ª–∞/–±—é–¥–∂–µ—Ç—ã –∑–∞—Ç—Ä–∞—Ç: `src/lib/domain/costRules.ts`.
  ‚Äì –†–µ–∑–µ—Ä–≤–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞: `src/lib/domain/fallbackPolicy.ts`.
- –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å: `src/lib/domain/comboResolver.ts`
- –ü–æ–ª–∏—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏: `src/lib/domain/lockoutPolicy.ts`.
- –ú–µ—Ö–∞–Ω–∏–∑–º –ø–æ–ª–∏—Ç–∏–∫–∏: `src/domain/policyEngine.ts` ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ ‚Üí –±—é–¥–∂–µ—Ç ‚Üí —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞.
- –ö–∞—Ç–∞–ª–æ–≥ –∫–æ–¥–æ–≤ –æ—à–∏–±–æ–∫: `src/lib/domain/errorCodes.ts`
- –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞: `src/lib/domain/requestId.ts`
  ‚Äì –¢–∞–π–º-–∞—É—Ç –ø–æ–ª—É—á–µ–Ω–∏—è: `src/lib/domain/fetchTimeout.ts`
- –ó–∞–ø—Ä–æ—Å —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏: `src/lib/domain/requestTelemetry.ts`
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ/–∞—É–¥–∏—Ç: `src/lib/domain/compliance/index.ts`
- –ë–µ–≥—É–Ω –æ—Ü–µ–Ω–∫–∏: `src/lib/domain/evalRunner.ts`
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–æ–º–µ–Ω–∞: `src/lib/db/domainState.ts` ‚Äî SQLite CRUD –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö —Ü–µ–ø–æ—á–µ–∫, –±—é–¥–∂–µ—Ç–æ–≤, –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞—Ç—Ä–∞—Ç, —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π.

–ú–æ–¥—É–ª–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ OAuth (12 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ–¥ `src/lib/oauth/providers/`):

- –ò–Ω–¥–µ–∫—Å —Ä–µ–µ—Å—Ç—Ä–∞: `src/lib/oauth/providers/index.ts`
- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏: `claude.ts`, `codex.ts`, `gemini.ts`, `antigravity.ts`, `iflow.ts`, `qwen.ts`, `kimi-coding.ts`, `github.ts`, `kiro.ts`, `cursor.ts`, `kilocode.ts`, `cline.ts`
  ‚Äî –¢–æ–Ω–∫–∞—è –æ–±–æ–ª–æ—á–∫–∞: `src/lib/oauth/providers.ts` ‚Äî —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç –∏–∑ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π.

## 3) –£—Ä–æ–≤–µ–Ω—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

–ü–µ—Ä–≤–∏—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ë–î:

- `src/lib/localDb.ts`
- —Ñ–∞–π–ª: `${DATA_DIR}/db.json` (–∏–ª–∏ `$XDG_CONFIG_HOME/omniroute/db.json`, –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∏–Ω–∞—á–µ `~/.omniroute/db.json`)
- —Å—É—â–Ω–æ—Å—Ç–∏: –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏ Connections, –ø–æ—Å—Ç–∞–≤—â–∏–∫Nodes, modelAliases, –∫–æ–º–±–æ, apiKeys, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, —Ü–µ–Ω—ã, **customModels**, **proxyConfig**, **ipFilter**, **thinkingBudget**, **systemPrompt**

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ë–î:

- `src/lib/usageDb.ts`
- —Ñ–∞–π–ª—ã: `${DATA_DIR}/usage.json`, `${DATA_DIR}/log.txt`, `${DATA_DIR}/call_logs/`
- —Å–ª–µ–¥—É–µ—Ç —Ç–æ–π –∂–µ –ø–æ–ª–∏—Ç–∏–∫–µ –±–∞–∑–æ–≤–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞, —á—Ç–æ –∏ `localDb` (`DATA_DIR`, –∑–∞—Ç–µ–º `XDG_CONFIG_HOME/omniroute`, –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)
- —Ä–∞–∑–ª–æ–∂–µ–Ω—ã –Ω–∞ —Ü–µ–ª–µ–≤—ã–µ –ø–æ–¥–º–æ–¥—É–ª–∏: `migrations.ts`, `usageHistory.ts`, `costCalculator.ts`, `usageStats.ts`, `callLogs.ts`

–ë–î —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–æ–º–µ–Ω–∞ (SQLite):

- `src/lib/db/domainState.ts` ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–∏ CRUD –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–æ–º–µ–Ω–∞.
- –¢–∞–±–ª–∏—Ü—ã (—Å–æ–∑–¥–∞–Ω–Ω—ã–µ –≤ `src/lib/db/core.ts`): `domain_fallback_chains`, `domain_budgets`, `domain_cost_history`, `domain_lockout_state`, `domain_circuit_breakers`
- –®–∞–±–ª–æ–Ω –∫—ç—à–∞ —Å–æ —Å–∫–≤–æ–∑–Ω–æ–π –∑–∞–ø–∏—Å—å—é: –∫–∞—Ä—Ç—ã –≤ –ø–∞–º—è—Ç–∏ —è–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω—ã–º–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è; –º—É—Ç–∞—Ü–∏–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤ SQLite; —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏–∑ –ë–î –ø—Ä–∏ —Ö–æ–ª–æ–¥–Ω–æ–º –∑–∞–ø—É—Å–∫–µ

## 4) –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

‚Äì –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ cookie –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–∞–Ω–µ–ª–∏: `src/proxy.ts`, `src/app/api/auth/login/route.ts`.

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è/–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞ API: `src/shared/utils/apiKey.ts`
- –°–µ–∫—Ä–µ—Ç—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å –≤ –∑–∞–ø–∏—Å—è—Ö `providerConnections`.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏—Å—Ö–æ–¥—è—â–µ–≥–æ –ø—Ä–æ–∫—Å–∏ —á–µ—Ä–µ–∑ `open-sse/utils/proxyFetch.ts` (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è) –∏ `open-sse/utils/networkProxy.ts` (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∏–ª–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ)

## 5) –û–±–ª–∞—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞: `src/lib/initCloudSync.ts`, `src/shared/services/initializeCloudSync.ts`
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞: `src/shared/services/cloudSyncScheduler.ts`.
- –ú–∞—Ä—à—Ä—É—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è: `src/app/api/sync/cloud/route.ts`

## –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–ø—Ä–æ—Å–∞ (`/v1/chat/completions`)

```mermaid
sequenceDiagram
    autonumber
    participant Client as CLI/SDK Client
    participant Route as /api/v1/chat/completions
    participant Chat as src/sse/handlers/chat
    participant Core as open-sse/handlers/chatCore
    participant Model as Model Resolver
    participant Auth as Credential Selector
    participant Exec as Provider Executor
    participant Prov as Upstream Provider
    participant Stream as Stream Translator
    participant Usage as usageDb

    Client->>Route: POST /v1/chat/completions
    Route->>Chat: handleChat(request)
    Chat->>Model: parse/resolve model or combo

    alt Combo model
        Chat->>Chat: iterate combo models (handleComboChat)
    end

    Chat->>Auth: getProviderCredentials(provider)
    Auth-->>Chat: active account + tokens/api key

    Chat->>Core: handleChatCore(body, modelInfo, credentials)
    Core->>Core: detect source format
    Core->>Core: translate request to target format
    Core->>Exec: execute(provider, transformedBody)
    Exec->>Prov: upstream API call
    Prov-->>Exec: SSE/JSON response
    Exec-->>Core: response + metadata

    alt 401/403
        Core->>Exec: refreshCredentials()
        Exec-->>Core: updated tokens
        Core->>Exec: retry request
    end

    Core->>Stream: translate/normalize stream to client format
    Stream-->>Client: SSE chunks / JSON response

    Stream->>Usage: extract usage + persist history/log
```

## –ö–æ–º–±–æ + –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏

```mermaid
flowchart TD
    A[Incoming model string] --> B{Is combo name?}
    B -- Yes --> C[Load combo models sequence]
    B -- No --> D[Single model path]

    C --> E[Try model N]
    E --> F[Resolve provider/model]
    D --> F

    F --> G[Select account credentials]
    G --> H{Credentials available?}
    H -- No --> I[Return provider unavailable]
    H -- Yes --> J[Execute request]

    J --> K{Success?}
    K -- Yes --> L[Return response]
    K -- No --> M{Fallback-eligible error?}

    M -- No --> N[Return error]
    M -- Yes --> O[Mark account unavailable cooldown]
    O --> P{Another account for provider?}
    P -- Yes --> G
    P -- No --> Q{In combo with next model?}
    Q -- Yes --> E
    Q -- No --> R[Return all unavailable]
```

–†–µ—à–µ–Ω–∏—è –æ–± –æ—Ç—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è `open-sse/services/accountFallback.ts` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–¥–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö.

## –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è OAuth –∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞

```mermaid
sequenceDiagram
    autonumber
    participant UI as Dashboard UI
    participant OAuth as /api/oauth/[provider]/[action]
    participant ProvAuth as Provider Auth Server
    participant DB as localDb
    participant Test as /api/providers/[id]/test
    participant Exec as Provider Executor

    UI->>OAuth: GET authorize or device-code
    OAuth->>ProvAuth: create auth/device flow
    ProvAuth-->>OAuth: auth URL or device code payload
    OAuth-->>UI: flow data

    UI->>OAuth: POST exchange or poll
    OAuth->>ProvAuth: token exchange/poll
    ProvAuth-->>OAuth: access/refresh tokens
    OAuth->>DB: createProviderConnection(oauth data)
    OAuth-->>UI: success + connection id

    UI->>Test: POST /api/providers/[id]/test
    Test->>Exec: validate credentials / optional refresh
    Exec-->>Test: valid or refreshed token info
    Test->>DB: update status/tokens/errors
    Test-->>UI: validation result
```

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è –∂–∏–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ `open-sse/handlers/chatCore.ts` —á–µ—Ä–µ–∑ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è `refreshCredentials()`.

## –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –æ–±–ª–∞—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–≤–∫–ª—é—á–∏—Ç—å/—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å/–æ—Ç–∫–ª—é—á–∏—Ç—å)

```mermaid
sequenceDiagram
    autonumber
    participant UI as Endpoint Page UI
    participant Sync as /api/sync/cloud
    participant DB as localDb
    participant Cloud as External Cloud Sync
    participant Claude as ~/.claude/settings.json

    UI->>Sync: POST action=enable
    Sync->>DB: set cloudEnabled=true
    Sync->>DB: ensure API key exists
    Sync->>Cloud: POST /sync/{machineId} (providers/aliases/combos/keys)
    Cloud-->>Sync: sync result
    Sync->>Cloud: GET /{machineId}/v1/verify
    Sync-->>UI: enabled + verification status

    UI->>Sync: POST action=sync
    Sync->>Cloud: POST /sync/{machineId}
    Cloud-->>Sync: remote data
    Sync->>DB: update newer local tokens/status
    Sync-->>UI: synced

    UI->>Sync: POST action=disable
    Sync->>DB: set cloudEnabled=false
    Sync->>Cloud: DELETE /sync/{machineId}
    Sync->>Claude: switch ANTHROPIC_BASE_URL back to local (if needed)
    Sync-->>UI: disabled
```

–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è `CloudSyncScheduler`, –∫–æ–≥–¥–∞ –æ–±–ª–∞–∫–æ –≤–∫–ª—é—á–µ–Ω–æ.

## –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –∏ –∫–∞—Ä—Ç–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

```mermaid
erDiagram
    SETTINGS ||--o{ PROVIDER_CONNECTION : controls
    PROVIDER_NODE ||--o{ PROVIDER_CONNECTION : backs_compatible_provider
    PROVIDER_CONNECTION ||--o{ USAGE_ENTRY : emits_usage

    SETTINGS {
      boolean cloudEnabled
      number stickyRoundRobinLimit
      boolean requireLogin
      string password_hash
      string fallbackStrategy
      json rateLimitDefaults
      json providerProfiles
    }

    PROVIDER_CONNECTION {
      string id
      string provider
      string authType
      string name
      number priority
      boolean isActive
      string apiKey
      string accessToken
      string refreshToken
      string expiresAt
      string testStatus
      string lastError
      string rateLimitedUntil
      json providerSpecificData
    }

    PROVIDER_NODE {
      string id
      string type
      string name
      string prefix
      string apiType
      string baseUrl
    }

    MODEL_ALIAS {
      string alias
      string targetModel
    }

    COMBO {
      string id
      string name
      string[] models
    }

    API_KEY {
      string id
      string name
      string key
      string machineId
    }

    USAGE_ENTRY {
      string provider
      string model
      number prompt_tokens
      number completion_tokens
      string connectionId
      string timestamp
    }

    CUSTOM_MODEL {
      string id
      string name
      string providerId
    }

    PROXY_CONFIG {
      string global
      json providers
    }

    IP_FILTER {
      string mode
      string[] allowlist
      string[] blocklist
    }

    THINKING_BUDGET {
      string mode
      number customBudget
      string effortLevel
    }

    SYSTEM_PROMPT {
      boolean enabled
      string prompt
      string position
    }
```

–§–∞–π–ª—ã —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:

- –æ—Å–Ω–æ–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `${DATA_DIR}/db.json` (–∏–ª–∏ `$XDG_CONFIG_HOME/omniroute/db.json`, –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, –∏–Ω–∞—á–µ `~/.omniroute/db.json`)
- —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: `${DATA_DIR}/usage.json`
- —Å—Ç—Ä–æ–∫–∏ –∂—É—Ä–Ω–∞–ª–∞ –∑–∞–ø—Ä–æ—Å–∞: `${DATA_DIR}/log.txt`
- –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–µ–∞–Ω—Å—ã –æ—Ç–ª–∞–¥–∫–∏ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞/–∑–∞–ø—Ä–æ—Å–∞: `<repo>/logs/...`

## –¢–æ–ø–æ–ª–æ–≥–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

```mermaid
flowchart LR
    subgraph LocalHost[Developer Host]
        CLI[CLI Tools]
        Browser[Dashboard Browser]
    end

    subgraph ContainerOrProcess[OmniRoute Runtime]
        Next[Next.js Server\nPORT=20128]
        Core[SSE Core + Executors]
        MainDB[(db.json)]
        UsageDB[(usage.json/log.txt)]
    end

    subgraph External[External Services]
        Providers[AI Providers]
        SyncCloud[Cloud Sync Service]
    end

    CLI --> Next
    Browser --> Next
    Next --> Core
    Next --> MainDB
    Core --> MainDB
    Core --> UsageDB
    Core --> Providers
    Next --> SyncCloud
```

## –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π)

### –ú–æ–¥—É–ª–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏ API

- `src/app/api/v1/*`, `src/app/api/v1beta/*`: API —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.
- `src/app/api/v1/providers/[provider]/*`: –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ (—á–∞—Ç, –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- `src/app/api/providers*`: CRUD –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- `src/app/api/provider-nodes*`: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏ —É–∑–ª–∞–º–∏.
- `src/app/api/provider-models`: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ (CRUD).
- `src/app/api/models/catalog`: API –ø–æ–ª–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞ –º–æ–¥–µ–ª–µ–π (–≤—Å–µ —Ç–∏–ø—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º)
- `src/app/api/oauth/*`: –ø–æ—Ç–æ–∫–∏ OAuth/–∫–æ–¥–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.
- `src/app/api/keys*`: –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞ API.
- `src/app/api/models/alias`: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Å–µ–≤–¥–æ–Ω–∏–º–∞–º–∏.
- `src/app/api/combos*`: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è–º–∏.
- `src/app/api/pricing`: –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–Ω –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∑–∞—Ç—Ä–∞—Ç.
- `src/app/api/settings/proxy`: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏ (GET/PUT/DELETE)
- `src/app/api/settings/proxy/test`: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ö–æ–¥—è—â–µ–≥–æ –ø—Ä–æ–∫—Å–∏-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (POST)
- `src/app/api/usage/*`: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ API.
- `src/app/api/sync/*` + `src/app/api/cloud/*`: –æ–±–ª–∞—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏ –ø–æ–º–æ—â–Ω–∏–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±–ª–∞–∫–æ–º.
- `src/app/api/cli-tools/*`: –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–∏/–ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ CLI.
- `src/app/api/settings/ip-filter`: —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö/–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤ (GET/PUT)
- `src/app/api/settings/thinking-budget`: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±—é–¥–∂–µ—Ç–∞ —Ç–æ–∫–µ–Ω–∞ (GET/PUT)
- `src/app/api/settings/system-prompt`: –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–Ω–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ (GET/PUT)
- `src/app/api/sessions`: —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ–∞–Ω—Å–æ–≤ (GET)
- `src/app/api/rate-limits`: —Å—Ç–∞—Ç—É—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ (GET)

### –Ø–¥—Ä–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

- `src/sse/handlers/chat.ts`: –∞–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–±–æ, —Ü–∏–∫–ª –≤—ã–±–æ—Ä–∞ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏.
- `open-sse/handlers/chatCore.ts`: —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è, –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–≤—Ç–æ—Ä–∞/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ç–æ–∫–∞.
- `open-sse/executors/*`: –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–µ—Ç–∏ –∏ —Ñ–æ—Ä–º–∞—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞.

### –†–µ–µ—Å—Ç—Ä –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∏ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã —Ñ–æ—Ä–º–∞—Ç–æ–≤

- `open-sse/translator/index.ts`: —Ä–µ–µ—Å—Ç—Ä —Ç—Ä–∞–Ω—Å–ª—è—Ç–æ—Ä–æ–≤ –∏ –æ—Ä–∫–µ—Å—Ç—Ä–æ–≤–∫–∞.
- –ó–∞–ø—Ä–æ—Å –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–≤: `open-sse/translator/request/*`
- –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤: `open-sse/translator/response/*`
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∞: `open-sse/translator/formats.ts`.

### –ù–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

- `src/lib/localDb.ts`: –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è/—Å–æ—Å—Ç–æ—è–Ω–∏–µ
- `src/lib/usageDb.ts`: –∏—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –∂—É—Ä–Ω–∞–ª—ã –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∑–∞–ø—Ä–æ—Å–æ–≤.

## –ü–æ–∫—Ä—ã—Ç–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞-–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è (—à–∞–±–ª–æ–Ω —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏)

–£ –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –µ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, —Ä–∞—Å—à–∏—Ä—è—é—â–∏–π `BaseExecutor` (–≤ `open-sse/executors/base.ts`), –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ URL-–∞–¥—Ä–µ—Å–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞, –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø–æ–ø—ã—Ç–∫—É —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –æ—Ç—Å—Ä–æ—á–∫–æ–π, –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –º–µ—Ç–æ–¥ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ `execute()`.

| –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å           | –ü–æ—Å—Ç–∞–≤—â–∏–∫(–∏)                                                                                                                                                 | –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞                                                            |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------- |
| `DefaultExecutor`     | OpenAI, Claude, Gemini, Qwen, iFlow, OpenRouter, GLM, Kimi, MiniMax, DeepSeek, Groq, xAI, Mistral, Perplexity, Together, Fireworks, Cerebras, Cohere, NVIDIA | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è URL/–∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞                   |
| `AntigravityExecutor` | Google –ê–Ω—Ç–∏–≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è                                                                                                                                        | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞/—Å–µ–∞–Ω—Å–∞, –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –ø–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞  |
| `CodexExecutor`       | –ö–æ–¥–µ–∫—Å OpenAI                                                                                                                                                | –í–≤–æ–¥–∏—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –º—ã—Å–ª–∏—Ç—å                                  |
| `CursorExecutor`      | –ö—É—Ä—Å–æ—Ä IDE                                                                                                                                                   | –ü—Ä–æ—Ç–æ–∫–æ–ª ConnectRPC, –∫–æ–¥–∏—Ä–æ–≤–∫–∞ Protobuf, –ø–æ–¥–ø–∏—Å—å –∑–∞–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Å—É–º–º—É |
| `GithubExecutor`      | –í—Ç–æ—Ä–æ–π –ø–∏–ª–æ—Ç GitHub                                                                                                                                          | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ Copilot, –∑–∞–≥–æ–ª–æ–≤–∫–∏, –∏–º–∏—Ç–∏—Ä—É—é—â–∏–µ VSCode                         |
| `KiroExecutor`        | AWS CodeWhisperer/–ö–∏—Ä–æ                                                                                                                                       | –ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç AWS EventStream ‚Üí –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ SSE                             |
| `GeminiCLIExecutor`   | –ë–ª–∏–∑–Ω–µ—Ü—ã CLI                                                                                                                                                 | –¶–∏–∫–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ Google OAuth                                              |

–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏ (–≤–∫–ª—é—á–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —É–∑–ª—ã) –∏—Å–ø–æ–ª—å–∑—É—é—Ç `DefaultExecutor`.

## –ú–∞—Ç—Ä–∏—Ü–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä           | –§–æ—Ä–º–∞—Ç         | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è                        | –ü–æ—Ç–æ–∫             | –ù–µ–ø–æ—Ç–æ–∫ | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ | API –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è            |
| ------------------- | -------------- | ---------------------------------- | ----------------- | ------- | ----------------- | ---------------------------- |
| –ö–ª–æ–¥                | –ö–ª–æ–¥           | –ö–ª—é—á API / OAuth                   | ‚úÖ                | ‚úÖ      | ‚úÖ                | ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä      |
| –ë–ª–∏–∑–Ω–µ—Ü—ã            | –±–ª–∏–∑–Ω–µ—Ü—ã       | –ö–ª—é—á API / OAuth                   | ‚úÖ                | ‚úÖ      | ‚úÖ                | ‚ö†Ô∏è –û–±–ª–∞—á–Ω–∞—è –∫–æ–Ω—Å–æ–ª—å          |
| –ë–ª–∏–∑–Ω–µ—Ü—ã CLI        | –ë–ª–∏–∑–Ω–µ—Ü—ã-–∫–ª–∏   | –û–ê—É—Ç–µ–Ω—Ç                            | ‚úÖ                | ‚úÖ      | ‚úÖ                | ‚ö†Ô∏è –û–±–ª–∞—á–Ω–∞—è –∫–æ–Ω—Å–æ–ª—å          |
| –ê–Ω—Ç–∏–≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è      | –∞–Ω—Ç–∏–≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è | –û–ê—É—Ç–µ–Ω—Ç                            | ‚úÖ                | ‚úÖ      | ‚úÖ                | ‚úÖ API —Å –ø–æ–ª–Ω–æ–π –∫–≤–æ—Ç–æ–π       |
| –û–ø–µ–Ω–ê–ò              | –æ–ø–µ–Ω–∞–π         | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| –ö–æ–¥–µ–∫—Å              | openai-–æ—Ç–≤–µ—Ç—ã  | –û–ê—É—Ç–µ–Ω—Ç                            | ‚úÖ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π | ‚ùå      | ‚úÖ                | ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å—Ç–∞–≤–æ–∫        |
| –í—Ç–æ—Ä–æ–π –ø–∏–ª–æ—Ç GitHub | –æ–ø–µ–Ω–∞–π         | OAuth + —Ç–æ–∫–µ–Ω –≤—Ç–æ—Ä–æ–≥–æ –ø–∏–ª–æ—Ç–∞       | ‚úÖ                | ‚úÖ      | ‚úÖ                | ‚úÖ –°–Ω–∏–º–∫–∏ –∫–≤–æ—Ç               |
| –ö—É—Ä—Å–æ—Ä              | –∫—É—Ä—Å–æ—Ä         | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞ | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| –ö–∏—Ä–æ                | –ö–∏—Ä–æ           | AWS SSO OIDC                       | ‚úÖ (EventStream)  | ‚ùå      | ‚úÖ                | ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è |
| –ö–≤–µ–Ω                | –æ–ø–µ–Ω–∞–π         | –û–ê—É—Ç–µ–Ω—Ç                            | ‚úÖ                | ‚úÖ      | ‚úÖ                | ‚ö†Ô∏è –ü–æ –∑–∞–ø—Ä–æ—Å—É                |
| iFlow               | –æ–ø–µ–Ω–∞–π         | OAuth (–±–∞–∑–æ–≤—ã–π)                    | ‚úÖ                | ‚úÖ      | ‚úÖ                | ‚ö†Ô∏è –ü–æ –∑–∞–ø—Ä–æ—Å—É                |
| OpenRouter          | –æ–ø–µ–Ω–∞–π         | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| –ì–õ–ú/–ö–∏–º–∏/–ú–∏–Ω–∏–ú–∞–∫—Å   | –ö–ª–æ–¥           | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| –î–∏–ø–°–∏–∫              | –æ–ø–µ–Ω–∞–π         | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| –ì—Ä–æ–∫                | –æ–ø–µ–Ω–∞–π         | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| xAI (–ì—Ä–æ–∫)          | –æ–ø–µ–Ω–∞–π         | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| –ú–∏—Å—Ç—Ä–∞–ª—å            | –æ–ø–µ–Ω–∞–π         | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| –†–∞—Å—Ç–µ—Ä—è–Ω–Ω–æ—Å—Ç—å       | –æ–ø–µ–Ω–∞–π         | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| –í–º–µ—Å—Ç–µ –ò–ò           | –æ–ø–µ–Ω–∞–π         | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| –§–µ–π–µ—Ä–≤–µ—Ä–∫ –ò–ò        | –æ–ø–µ–Ω–∞–π         | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| –¶–µ—Ä–µ–±—Ä–∞             | –æ–ø–µ–Ω–∞–π         | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ         | –æ–ø–µ–Ω–∞–π         | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |
| NVIDIA –ù–ò–ú          | –æ–ø–µ–Ω–∞–π         | API-–∫–ª—é—á                           | ‚úÖ                | ‚úÖ      | ‚ùå                | ‚ùå                           |

## –û—Ö–≤–∞—Ç –ø–µ—Ä–µ–≤–æ–¥–∞ —Ñ–æ—Ä–º–∞—Ç–∞

–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –≤–∫–ª—é—á–∞—é—Ç:

- `openai`
- `openai-responses`
- `claude`
- `gemini`

–¶–µ–ª–µ–≤—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –≤–∫–ª—é—á–∞—é—Ç:

- –ß–∞—Ç OpenAI/–û—Ç–≤–µ—Ç—ã
- –ö–ª–æ–¥
- –û–±–æ–ª–æ—á–∫–∞ Gemini/Gemini-CLI/–ê–Ω—Ç–∏–≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è
- –ö–∏—Ä–æ
- –ö—É—Ä—Å–æ—Ä

–í –ø–µ—Ä–µ–≤–æ–¥–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **OpenAI –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ö–∞–±-—Ñ–æ—Ä–º–∞—Ç–∞** ‚Äî –≤—Å–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ OpenAI –∫–∞–∫ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:

```
Source Format ‚Üí OpenAI (hub) ‚Üí Target Format
```

–ü–µ—Ä–µ–≤–æ–¥—ã –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–æ—Ä–º—ã –∏—Å—Ö–æ–¥–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ —Ü–µ–ª–µ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ –∫–æ–Ω–≤–µ–π–µ—Ä–µ –ø–µ—Ä–µ–≤–æ–¥–∞:

- **–û–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤**¬†‚Äî —É–¥–∞–ª—è–µ—Ç –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–ª—è –∏–∑ –æ—Ç–≤–µ—Ç–æ–≤ —Ñ–æ—Ä–º–∞—Ç–∞ OpenAI (–∫–∞–∫ –ø–æ—Ç–æ–∫–æ–≤—ã—Ö, —Ç–∞–∫ –∏ –Ω–µ–ø–æ—Ç–æ–∫–æ–≤—ã—Ö) –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å—Ç—Ä–æ–≥–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è SDK.
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ–ª–µ–π** ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç `developer` ‚Üí `system` –¥–ª—è —Ü–µ–ª–µ–π, –æ—Ç–ª–∏—á–Ω—ã—Ö –æ—Ç OpenAI; –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç `system` ‚Üí `user` –¥–ª—è –º–æ–¥–µ–ª–µ–π, –æ—Ç–≤–µ—Ä–≥–∞—é—â–∏—Ö —Å–∏—Å—Ç–µ–º–Ω—É—é —Ä–æ–ª—å (GLM, ERNIE)
- **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–≥–æ–≤** ‚Äî –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –±–ª–æ–∫–∏ `<think>...</think>` –∏–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤ –ø–æ–ª–µ `reasoning_content`.
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥** ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç OpenAI `response_format.json_schema` –≤ Gemini `responseMimeType` + `responseSchema`.

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ API

| –ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞                                     | –§–æ—Ä–º–∞—Ç                   | –û–±—Ä–∞–±–æ—Ç—á–∏–∫                                                              |
| -------------------------------------------------- | ------------------------ | ----------------------------------------------------------------------- |
| `POST /v1/chat/completions`                        | –ß–∞—Ç OpenAI               | `src/sse/handlers/chat.ts`                                              |
| `POST /v1/messages`                                | –ö–ª–æ–¥ –°–æ–æ–±—â–µ–Ω–∏—è           | –¢–æ—Ç –∂–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)                          |
| `POST /v1/responses`                               | –û—Ç–≤–µ—Ç—ã OpenAI            | `open-sse/handlers/responsesHandler.ts`                                 |
| `POST /v1/embeddings`                              | –í–ª–æ–∂–µ–Ω–∏—è OpenAI          | `open-sse/handlers/embeddings.ts`                                       |
| `GET /v1/embeddings`                               | –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π           | API-–º–∞—Ä—à—Ä—É—Ç                                                             |
| `POST /v1/images/generations`                      | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è OpenAI       | `open-sse/handlers/imageGeneration.ts`                                  |
| `GET /v1/images/generations`                       | –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π           | API-–º–∞—Ä—à—Ä—É—Ç                                                             |
| `POST /v1/providers/{provider}/chat/completions`   | –ß–∞—Ç OpenAI               | –í—ã–¥–µ–ª–µ–Ω–Ω—ã–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –º–æ–¥–µ–ª–∏                    |
| `POST /v1/providers/{provider}/embeddings`         | –í–ª–æ–∂–µ–Ω–∏—è OpenAI          | –í—ã–¥–µ–ª–µ–Ω–Ω—ã–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –º–æ–¥–µ–ª–∏                    |
| `POST /v1/providers/{provider}/images/generations` | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è OpenAI       | –í—ã–¥–µ–ª–µ–Ω–Ω—ã–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –º–æ–¥–µ–ª–∏                    |
| `POST /v1/messages/count_tokens`                   | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–µ—Ç–æ–Ω–æ–≤ –ö–ª–æ–¥–∞ | API-–º–∞—Ä—à—Ä—É—Ç                                                             |
| `GET /v1/models`                                   | –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π OpenAI    | –ú–∞—Ä—à—Ä—É—Ç API (—á–∞—Ç + –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ + –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–æ–¥–µ–ª–∏) |
| `GET /api/models/catalog`                          | –ö–∞—Ç–∞–ª–æ–≥                  | –í—Å–µ –º–æ–¥–µ–ª–∏ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫—É + —Ç–∏–ø—É                           |
| `POST /v1beta/models/*:streamGenerateContent`      | –£—Ä–æ–∂–µ–Ω–µ—Ü –ë–ª–∏–∑–Ω–µ—Ü–æ–≤       | API-–º–∞—Ä—à—Ä—É—Ç                                                             |
| `GET/PUT/DELETE /api/settings/proxy`               | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏      | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ –ø—Ä–æ–∫—Å–∏                                            |
| `POST /api/settings/proxy/test`                    | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ | –ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏/–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞    |
| `GET/POST/DELETE /api/provider-models`             | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–æ–¥–µ–ª–∏  | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞            |

## –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–±—Ö–æ–¥–∞

–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–±—Ö–æ–¥–∞ (`open-sse/utils/bypassHandler.ts`) –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã–µ ¬´–æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ¬ª –∑–∞–ø—Ä–æ—Å—ã –æ—Ç Claude CLI ‚Äî –ø–∏–Ω–≥–∏ –ø—Ä–æ–≥—Ä–µ–≤–∞, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏ –ø–æ–¥—Å—á–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤ ‚Äî –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–ø–æ–¥–¥–µ–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç** –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ –≤—ã—à–µ—Å—Ç–æ—è—â–µ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞. –≠—Ç–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ `User-Agent` —Å–æ–¥–µ—Ä–∂–∏—Ç `claude-cli`.

## –ö–æ–Ω–≤–µ–π–µ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

–†–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ (`open-sse/utils/requestLogger.ts`) –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç 7-—ç—Ç–∞–ø–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–ª–∞–¥–∫–∏, –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ –≤–∫–ª—é—á–µ–Ω–Ω—ã–π —á–µ—Ä–µ–∑ `ENABLE_REQUEST_LOGS=true`:

```
1_req_client.json ‚Üí 2_req_source.json ‚Üí 3_req_openai.json ‚Üí 4_req_target.json
‚Üí 5_res_provider.txt ‚Üí 6_res_openai.txt ‚Üí 7_res_client.txt
```

–§–∞–π–ª—ã –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ `<repo>/logs/<session>/` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–∞–Ω—Å–∞ –∑–∞–ø—Ä–æ—Å–∞.

## –†–µ–∂–∏–º—ã –æ—Ç–∫–∞–∑–æ–≤ –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

## 1) –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏/–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

- –í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ø–µ—Ä–µ—Ö–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞/—Å–∫–æ—Ä–æ—Å—Ç–∏/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –ø–µ—Ä–µ–¥ –Ω–µ—É–¥–∞—á–Ω—ã–º –∑–∞–ø—Ä–æ—Å–æ–º
- –æ—Ç–∫–∞—Ç –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏, –∫–æ–≥–¥–∞ —Ç–µ–∫—É—â–∏–π –ø—É—Ç—å –º–æ–¥–µ–ª–∏/–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∏—Å—á–µ—Ä–ø–∞–Ω.

## 2) –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞

- –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –ø–æ–≤—Ç–æ—Ä–æ–º –¥–ª—è –æ–±–Ω–æ–≤–ª—è–µ–º—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ 401/403 –ø–æ—Å–ª–µ –ø–æ–ø—ã—Ç–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ –æ—Å–Ω–æ–≤–Ω–æ–º—É –ø—É—Ç–∏.

## 3) –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏

- –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø–æ—Ç–æ–∫–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
- –ø–æ—Ç–æ–∫ –ø–µ—Ä–µ–≤–æ–¥–∞ —Å–æ —Å–±—Ä–æ—Å–æ–º –∫–æ–Ω—Ü–∞ –ø–æ—Ç–æ–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π `[DONE]`
- –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ü–µ–Ω–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –∫–æ–≥–¥–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.

## 4) –î–µ–≥—Ä–∞–¥–∞—Ü–∏—è –æ–±–ª–∞—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

- –û–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –æ—à–∏–±–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è.
- –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∏–º–µ–µ—Ç –ª–æ–≥–∏–∫—É —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫, –Ω–æ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–∑—ã–≤–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å –æ–¥–Ω–æ–π –ø–æ–ø—ã—Ç–∫–æ–π.

## 5) –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

- –ú–∏–≥—Ä–∞—Ü–∏—è/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã –ë–î –¥–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–ª—é—á–µ–π.
- –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã —Å—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞—â–∏—Ç—ã —Å–±—Ä–æ—Å–∞ JSON –¥–ª—è localDb –∏ useDb.

## –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å –∏ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã

–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

- –ª–æ–≥–∏ –∫–æ–Ω—Å–æ–ª–∏ –æ—Ç `src/sse/utils/logger.ts`
- –∞–≥—Ä–µ–≥–∞—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ –∑–∞–ø—Ä–æ—Å—É –≤ `usage.json`
- –∂—É—Ä–Ω–∞–ª —Å—Ç–∞—Ç—É—Å–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤ `log.txt`
- –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∂—É—Ä–Ω–∞–ª—ã –≥–ª—É–±–æ–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤/—Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–π –ø–æ–¥ `logs/`, –∫–æ–≥–¥–∞ `ENABLE_REQUEST_LOGS=true`
- –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–∞–Ω–µ–ª–∏ (`/api/usage/*`) –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

## –ì—Ä–∞–Ω–∏—Ü—ã, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- –°–µ–∫—Ä–µ—Ç JWT (`JWT_SECRET`) –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É/–ø–æ–¥–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤ cookie —Å–µ–∞–Ω—Å–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–∞–Ω–µ–ª–∏.
- –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –ø–∞—Ä–æ–ª—å (`INITIAL_PASSWORD`, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `123456`) –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è—Ö.
- –°–µ–∫—Ä–µ—Ç HMAC –∫–ª—é—á–∞ API (`API_KEY_SECRET`) –∑–∞—â–∏—â–∞–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞ API.
- –°–µ–∫—Ä–µ—Ç—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ (–∫–ª—é—á–∏/—Ç–æ–∫–µ–Ω—ã API) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞—â–∏—â–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.
- –ö–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ –æ–±–ª–∞—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–∞–≥–∞—é—Ç—Å—è –Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ –∫–ª—é—á—É API + —Å–µ–º–∞–Ω—Ç–∏–∫—É –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –º–∞—à–∏–Ω—ã.

## –ú–∞—Ç—Ä–∏—Ü–∞ —Å—Ä–µ–¥—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã, –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–¥–æ–º:

- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: `JWT_SECRET`, `INITIAL_PASSWORD`.
- –•—Ä–∞–Ω–∏–ª–∏—â–µ: `DATA_DIR`
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —É–∑–ª–∞: `ALLOW_MULTI_CONNECTIONS_PER_COMPAT_NODE`.
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∞–∑—ã —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (Linux/macOS, –µ—Å–ª–∏ `DATA_DIR` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ): `XDG_CONFIG_HOME`
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: `API_KEY_SECRET`, `MACHINE_ID_SALT`.
- –í–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞: `ENABLE_REQUEST_LOGS`
  ‚Äì URL-–∞–¥—Ä–µ—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏/–æ–±–ª–∞–∫–∞: `NEXT_PUBLIC_BASE_URL`, `NEXT_PUBLIC_CLOUD_URL`.
- –ò—Å—Ö–æ–¥—è—â–∏–π –ø—Ä–æ–∫—Å–∏: `HTTP_PROXY`, `HTTPS_PROXY`, `ALL_PROXY`, `NO_PROXY` –∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ.
- –§–ª–∞–≥–∏ —Ñ—É–Ω–∫—Ü–∏–π SOCKS5: `ENABLE_SOCKS5_PROXY`, `NEXT_PUBLIC_ENABLE_SOCKS5_PROXY`.
- –ü–æ–º–æ—â–Ω–∏–∫–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã/—Å—Ä–µ–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–Ω–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è): `APPDATA`, `NODE_ENV`, `PORT`, `HOSTNAME`.

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

1. `usageDb` –∏ `localDb` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ –±–∞–∑–æ–≤—É—é –ø–æ–ª–∏—Ç–∏–∫—É –∫–∞—Ç–∞–ª–æ–≥–æ–≤ (`DATA_DIR` -> `XDG_CONFIG_HOME/omniroute` -> `~/.omniroute`) —Å –º–∏–≥—Ä–∞—Ü–∏–µ–π —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Ñ–∞–π–ª–æ–≤.
2. `/api/v1/route.ts` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π –∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –º–æ–¥–µ–ª–µ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º `/v1/models`.
3. –†–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏/—Ç–µ–ª–æ, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω; —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –∂—É—Ä–Ω–∞–ª–æ–≤ –∫–∞–∫ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π.
4. –ü–æ–≤–µ–¥–µ–Ω–∏–µ –æ–±–ª–∞–∫–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ `NEXT_PUBLIC_BASE_URL` –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–∫–∏ –æ–±–ª–∞–∫–∞.
5. –ö–∞—Ç–∞–ª–æ–≥ `open-sse/` –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –∫–∞–∫ `@omniroute/open-sse` **–ø–∞–∫–µ—Ç —Ä–∞–±–æ—á–µ–π –æ–±–ª–∞—Å—Ç–∏ npm**. –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –µ–≥–æ —á–µ—Ä–µ–∑ `@omniroute/open-sse/...` (—Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è Next.js `transpilePackages`). –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –≤ —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏–º—è –∫–∞—Ç–∞–ª–æ–≥–∞ `open-sse/` –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è.
6. –í –¥–∏–∞–≥—Ä–∞–º–º–∞—Ö –Ω–∞ –ø–∞–Ω–µ–ª–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **Recharts** (–Ω–∞ –æ—Å–Ω–æ–≤–µ SVG) –¥–ª—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π (—Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏, —Ç–∞–±–ª–∏—Ü—ã —Ä–∞–∑–±–∏–≤–∫–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ —Å –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏).
7. –í —Ç–µ—Å—Ç–∞—Ö E2E –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Playwright** (`tests/e2e/`), –∑–∞–ø—É—Å–∫–∞–µ–º—ã–π —á–µ—Ä–µ–∑ `npm run test:e2e`. –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç **—Å—Ä–µ–¥—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ Node.js** (`tests/unit/`), –∑–∞–ø—É—Å–∫–∞–µ–º–æ–µ —á–µ—Ä–µ–∑ `npm run test:plan3`. –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ `src/` ‚Äî **TypeScript** (`.ts`/`.tsx`); —Ä–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å `open-sse/` –æ—Å—Ç–∞—ë—Ç—Å—è JavaScript (`.js`).
8. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ 5 –≤–∫–ª–∞–¥–æ–∫: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è (6 –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π: —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ, —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑, p2c, —Å–ª—É—á–∞–π–Ω–∞—è, –Ω–∞–∏–º–µ–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞—Ç—Ä–∞—Ç), –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—å, –ø–æ–ª–∏—Ç–∏–∫–∏), AI (–ø—Ä–æ–¥—É–º—ã–≤–∞–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞, —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏, –∫–µ—à –ø–æ–¥—Å–∫–∞–∑–æ–∫), –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (–ø—Ä–æ–∫—Å–∏).

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

- –°–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞: `npm run build`.
- –°–æ–∑–¥–∞–π—Ç–µ –æ–±—Ä–∞–∑ Docker: `docker build -t omniroute .`.
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É–∂–±—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- `GET /api/settings`
- `GET /api/v1/models`
- –¶–µ–ª–µ–≤–æ–π –±–∞–∑–æ–≤—ã–π URL-–∞–¥—Ä–µ—Å CLI –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `http://<host>:20128/v1`, –∫–æ–≥–¥–∞ `PORT=20128`.
